{
	"Id": "6d4a6a44f1dd0b4c4d2b18470d76d33400a0f77a",
	"active": "true",
	"enabled": "true",
	"code": "c++",
	"date": "2024-10-20T01:52:27.236Z",
	"name": "C++",
	"remark": "LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoqKioqKioqKioqKioqKioqKioqKiAgICAgICAgQVBJIFNlcnZlciBTdHViIGZvciBDKysgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioNCioqKioqKioqKioqKioqKioqKioqIFZFUlNJT046IDIwMjQtMTAtMjBUMDE6NTI6MjQuOTk1WiAgKioqKioqKioqKioqKioqKioqKioNCioqKioqKioqKioqKioqKioqKioqICBTWVNURU06IGFwaXNlcnZlci9lc3B0ZXN0ICAgICAqKioqKioqKioqKioqKioqKioqKg0KKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQoNCg0KDQovKiBMaW51eCBydW5uZXI6DQp3Z2V0IC1xTy0gImh0dHBzOi8vYXJ6aG9zcGl0YWwuZ2l0aHViLmlvL2VzcHRlc3QvTm9kZV9UeXBlL0MrKy5qc29uIiB8IGpxIC1yICcucmVtYXJrIHwgQGJhc2U2NGQnIHwgZysrIC14IGMrKyAtDQoNCg0KKi8NCg0KDQojaW5jbHVkZSA8Y3RpbWU+DQojaW5jbHVkZSA8c3RyaW5nPg0KI2luY2x1ZGUgImJpdHMvc3RkYysrLmgiDQojaW5jbHVkZSA8Y2hyb25vPg0KI2luY2x1ZGUgImluY2x1ZGUvanNvbi5ocHAiDQojaW5jbHVkZSAibXF0dC9hc3luY19jbGllbnQuaCINCiNpbmNsdWRlICJtcXR0L3RvcGljLmgiDQoNCnVzaW5nIGpzb24gPSBubG9obWFubjo6anNvbjsNCg0KDQpuYW1lc3BhY2UgZXNwdGVzdHsKCQpuYW1lc3BhY2UgY29tewoJCm5hbWVzcGFjZSBuYW1tb3VyewoJCm5hbWVzcGFjZSBkY29tewoJDQogICAgDQogICAgY2xhc3MgQ29uZmlnX0dyb3Vwew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBDb25maWdfR3JvdXAoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+Q29uZmlnX0dyb3VwKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgQ29uZmlnX0dyb3VwJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuZ3JvdXBfQ29uZmlncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2dyb3VwX0NvbmZpZ3M7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBncm91cF9Db25maWdzKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIGdyb3VwX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5ncm91cF9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmdyb3VwX01hcHBpbmdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZ3JvdXBfTWFwcGluZ3M7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBncm91cF9NYXBwaW5ncygpOw0KICAgICAgICAgICAgQ29uZmlnX0dyb3VwJiBncm91cF9NYXBwaW5ncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmdyb3VwX01hcHBpbmdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBNYXBwaW5nX0dyb3Vwew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk1hcHBpbmdfR3JvdXAoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nX0dyb3VwLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTWFwcGluZ19Hcm91cCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE1hcHBpbmdfR3JvdXAmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE1hcHBpbmdfR3JvdXAmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1hcHBpbmdfR3JvdXAmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIFRvb2xfVHlwZXsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgVG9vbF9UeXBlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgflRvb2xfVHlwZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIFRvb2xfVHlwZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBUb29sX1R5cGUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBUb29sX1R5cGUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBUb29sX1R5cGUmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLnR5cGVfQ29uZmlncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3R5cGVfQ29uZmlnczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHR5cGVfQ29uZmlncygpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiB0eXBlX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS50eXBlX0NvbmZpZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUudHlwZV9Ub29scyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3R5cGVfVG9vbHM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB0eXBlX1Rvb2xzKCk7DQogICAgICAgICAgICBUb29sX1R5cGUmIHR5cGVfVG9vbHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS50eXBlX1Rvb2xzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLnR5cGVfTWFwcGluZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF90eXBlX01hcHBpbmdzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdHlwZV9NYXBwaW5ncygpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiB0eXBlX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUudHlwZV9NYXBwaW5ncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgVG9vbF9UeXBlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBUb29sX1R5cGUmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTm9kZV9Db250ZXh0ew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlX0NvbnRleHQoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+Tm9kZV9Db250ZXh0KCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0Lm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQuY29udGV4dF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2NvbnRleHRfTm9kZXM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBjb250ZXh0X05vZGVzKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIGNvbnRleHRfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5jb250ZXh0X05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBOb2RlX0dyb3Vwew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlX0dyb3VwKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk5vZGVfR3JvdXAoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTm9kZV9Hcm91cCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlX0dyb3VwJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLmdyb3VwX05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZ3JvdXBfTm9kZXM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBncm91cF9Ob2RlcygpOw0KICAgICAgICAgICAgTm9kZV9Hcm91cCYgZ3JvdXBfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuZ3JvdXBfTm9kZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE5vZGVfVHlwZXsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTm9kZV9UeXBlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk5vZGVfVHlwZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTm9kZV9UeXBlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTm9kZV9UeXBlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTm9kZV9UeXBlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTm9kZV9UeXBlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlX1R5cGUmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5keW5hbWljIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2R5bmFtaWM7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBkeW5hbWljKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIGR5bmFtaWMoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5keW5hbWljIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUudHlwZV9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3R5cGVfTm9kZXM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB0eXBlX05vZGVzKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIHR5cGVfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS50eXBlX05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlX1R5cGUmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBUb29sew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBUb29sKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgflRvb2woKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBUb29sJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBUb29sJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgVG9vbCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIFRvb2wmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBUb29sJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBUb29sJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIFRvb2wmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBUb29sJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBfdHlwZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdHlwZSgpOw0KICAgICAgICAgICAgVG9vbCYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgVG9vbCYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wudG9vbF9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdG9vbF9Db25maWdzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdG9vbF9Db25maWdzKCk7DQogICAgICAgICAgICBUb29sJiB0b29sX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wudG9vbF9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC50b29sX01hcHBpbmdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdG9vbF9NYXBwaW5nczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHRvb2xfTWFwcGluZ3MoKTsNCiAgICAgICAgICAgIFRvb2wmIHRvb2xfTWFwcGluZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wudG9vbF9NYXBwaW5ncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgVG9vbCYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIFRvb2wmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIFRvb2wmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTWFwcGluZ3sNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWFwcGluZygpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5NYXBwaW5nKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTWFwcGluZyYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTWFwcGluZyYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgTWFwcGluZyYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuY2xhc3NOYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jbGFzc05hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY2xhc3NOYW1lKCk7DQogICAgICAgICAgICBNYXBwaW5nJiBjbGFzc05hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmNsYXNzTmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuc2NvcGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3Njb3BlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHNjb3BlKCk7DQogICAgICAgICAgICBNYXBwaW5nJiBzY29wZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuc2NvcGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmNvbnRleHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvbnRleHQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29udGV4dCgpOw0KICAgICAgICAgICAgTWFwcGluZyYgY29udGV4dChzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuY29udGV4dCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuc291cmNlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9zb3VyY2U7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgc291cmNlKCk7DQogICAgICAgICAgICBNYXBwaW5nJiBzb3VyY2Uoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLnNvdXJjZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcudGFyZ2V0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90YXJnZXQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgdGFyZ2V0KCk7DQogICAgICAgICAgICBNYXBwaW5nJiB0YXJnZXQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLnRhcmdldCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuaW5TY3JpcHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2luU2NyaXB0Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGluU2NyaXB0KCk7DQogICAgICAgICAgICBNYXBwaW5nJiBpblNjcmlwdChzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNYXBwaW5nJiBpblNjcmlwdChqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5pblNjcmlwdCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcub3V0U2NyaXB0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9vdXRTY3JpcHQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgb3V0U2NyaXB0KCk7DQogICAgICAgICAgICBNYXBwaW5nJiBvdXRTY3JpcHQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWFwcGluZyYgb3V0U2NyaXB0KGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLm91dFNjcmlwdCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcudG9vbCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIF90b29sOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogdG9vbCgpOw0KICAgICAgICAgICAgTWFwcGluZyYgdG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1hcHBpbmcmIHRvb2woZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcudG9vbCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuZ3JvdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogZ3JvdXAoKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIGdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNYXBwaW5nJiBncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBfdHlwZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdHlwZSgpOw0KICAgICAgICAgICAgTWFwcGluZyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWFwcGluZyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWFwcGluZyYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTm9kZXsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTm9kZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5Ob2RlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTm9kZSYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTm9kZSYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE5vZGUmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBOb2RlJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTm9kZSYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTm9kZSYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBOb2RlJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTm9kZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuYWRkcmVzcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfYWRkcmVzczsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBhZGRyZXNzKCk7DQogICAgICAgICAgICBOb2RlJiBhZGRyZXNzKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5hZGRyZXNzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5iYWNrdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBfYmFja3VwOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogYmFja3VwKCk7DQogICAgICAgICAgICBOb2RlJiBiYWNrdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlJiBiYWNrdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuYmFja3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5wYXJlbnQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBfcGFyZW50Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogcGFyZW50KCk7DQogICAgICAgICAgICBOb2RlJiBwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlJiBwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucGFyZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5ncm91cCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIGdyb3VwKCk7DQogICAgICAgICAgICBOb2RlJiBncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGUmIGdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5jb250ZXh0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0KiBfY29udGV4dDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCogY29udGV4dCgpOw0KICAgICAgICAgICAgTm9kZSYgY29udGV4dChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTm9kZSYgY29udGV4dChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvbnRleHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnBvcnQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9wb3J0Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBwb3J0KCk7DQogICAgICAgICAgICBOb2RlJiBwb3J0KGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucG9ydCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUub25saW5lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfb25saW5lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBvbmxpbmUoKTsNCiAgICAgICAgICAgIE5vZGUmIG9ubGluZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm9ubGluZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuc2VjdXJlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX3NlY3VyZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIHNlY3VyZSgpOw0KICAgICAgICAgICAgTm9kZSYgc2VjdXJlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnNlY3VyZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSogX3R5cGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUqIHR5cGUoKTsNCiAgICAgICAgICAgIE5vZGUmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGUmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvbnRyb2xsZXJfRGV2aWNlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2NvbnRyb2xsZXJfRGV2aWNlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGNvbnRyb2xsZXJfRGV2aWNlcygpOw0KICAgICAgICAgICAgTm9kZSYgY29udHJvbGxlcl9EZXZpY2VzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvbnRyb2xsZXJfRGV2aWNlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUubm9kZV9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfbm9kZV9Db25maWdzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgbm9kZV9Db25maWdzKCk7DQogICAgICAgICAgICBOb2RlJiBub2RlX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUubm9kZV9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5jYXJyaWVyX0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2NhcnJpZXJfRXZlbnRzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgY2Fycmllcl9FdmVudHMoKTsNCiAgICAgICAgICAgIE5vZGUmIGNhcnJpZXJfRXZlbnRzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNhcnJpZXJfRXZlbnRzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5zZW5kZXJfRXZlbnRzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfc2VuZGVyX0V2ZW50czsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHNlbmRlcl9FdmVudHMoKTsNCiAgICAgICAgICAgIE5vZGUmIHNlbmRlcl9FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuc2VuZGVyX0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucmVjaXBpZW50X0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3JlY2lwaWVudF9FdmVudHM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiByZWNpcGllbnRfRXZlbnRzKCk7DQogICAgICAgICAgICBOb2RlJiByZWNpcGllbnRfRXZlbnRzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnJlY2lwaWVudF9FdmVudHMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmJhY2t1cF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2JhY2t1cF9Ob2RlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGJhY2t1cF9Ob2RlcygpOw0KICAgICAgICAgICAgTm9kZSYgYmFja3VwX05vZGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmJhY2t1cF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucGFyZW50X05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfcGFyZW50X05vZGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgcGFyZW50X05vZGVzKCk7DQogICAgICAgICAgICBOb2RlJiBwYXJlbnRfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucGFyZW50X05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTm9kZSYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgTm9kZSYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZT4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBmaW5kKCk7DQogICAgDQogICAgICAgIGpzb24gYXV0aENvZGUoc3RkOjpzdHJpbmcgY29kZSwgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiB0b29sKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBpbml0KGludCBvbmxpbmUsIHN0ZDo6c3RyaW5nIGNvZGUsIHN0ZDo6c3RyaW5nIHVpZCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBDb25maWd7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIENvbmZpZygpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5Db25maWcoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIENvbmZpZyYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIENvbmZpZyYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBDb25maWcmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgQ29uZmlnJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIENvbmZpZyYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIENvbmZpZyYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgQ29uZmlnJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgQ29uZmlnJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcudmFsdWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3ZhbHVlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHZhbHVlKCk7DQogICAgICAgICAgICBDb25maWcmIHZhbHVlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgdmFsdWUoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy52YWx1ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5zY3JpcHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3NjcmlwdDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBzY3JpcHQoKTsNCiAgICAgICAgICAgIENvbmZpZyYgc2NyaXB0KHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgc2NyaXB0KGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuc2NyaXB0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnRvb2wgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sKiBfdG9vbDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIHRvb2woKTsNCiAgICAgICAgICAgIENvbmZpZyYgdG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgdG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnRvb2wgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuZ3JvdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogZ3JvdXAoKTsNCiAgICAgICAgICAgIENvbmZpZyYgZ3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgZ3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIF90eXBlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiB0eXBlKCk7DQogICAgICAgICAgICBDb25maWcmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5ub2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX25vZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBub2RlKCk7DQogICAgICAgICAgICBDb25maWcmIG5vZGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBDb25maWcmIG5vZGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5ub2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIENvbmZpZyYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIENvbmZpZyYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgQ29uZmlnJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZz4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIEV2ZW50ew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBFdmVudCgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5FdmVudCgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBFdmVudCYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBFdmVudCYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgRXZlbnQmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIEV2ZW50JiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBFdmVudCYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBFdmVudCYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50Lm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIEV2ZW50JiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRXZlbnQmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuY2xhc3NOYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jbGFzc05hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY2xhc3NOYW1lKCk7DQogICAgICAgICAgICBFdmVudCYgY2xhc3NOYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuY2xhc3NOYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQubWV0aG9kIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9tZXRob2Q7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbWV0aG9kKCk7DQogICAgICAgICAgICBFdmVudCYgbWV0aG9kKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQubWV0aG9kIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucGF5bG9hZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcGF5bG9hZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBwYXlsb2FkKCk7DQogICAgICAgICAgICBFdmVudCYgcGF5bG9hZChzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBFdmVudCYgcGF5bG9hZChqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucGF5bG9hZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmNhcnJpZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBfY2FycmllcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGNhcnJpZXIoKTsNCiAgICAgICAgICAgIEV2ZW50JiBjYXJyaWVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRXZlbnQmIGNhcnJpZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmNhcnJpZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5zZW5kZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBfc2VuZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogc2VuZGVyKCk7DQogICAgICAgICAgICBFdmVudCYgc2VuZGVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRXZlbnQmIHNlbmRlcihlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuc2VuZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucmVjaXBpZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX3JlY2lwaWVudDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHJlY2lwaWVudCgpOw0KICAgICAgICAgICAgRXZlbnQmIHJlY2lwaWVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIEV2ZW50JiByZWNpcGllbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnJlY2lwaWVudCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnJlc3BvbnNlVG8gR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCogX3Jlc3BvbnNlVG87DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCogcmVzcG9uc2VUbygpOw0KICAgICAgICAgICAgRXZlbnQmIHJlc3BvbnNlVG8oZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRXZlbnQmIHJlc3BvbnNlVG8oZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5yZXNwb25zZVRvIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5yZXNwb25zZVRvX0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3Jlc3BvbnNlVG9fRXZlbnRzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgcmVzcG9uc2VUb19FdmVudHMoKTsNCiAgICAgICAgICAgIEV2ZW50JiByZXNwb25zZVRvX0V2ZW50cyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucmVzcG9uc2VUb19FdmVudHMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIEV2ZW50JiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgRXZlbnQmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIEV2ZW50JiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGZpbmQoKTsNCiAgICANCiAgICAgICAganNvbiBsaXN0ZW4oZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBub2RlKTsNCiAgICANCiAgICAgICAganNvbiB0cmlnZ2VyKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIHByb2Nlc3MoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KfQoJCn0KCQp9CgkKfQoJDQoNCm5hbWVzcGFjZSBlc3B0ZXN0ewoJCm5hbWVzcGFjZSBjb217CgkKbmFtZXNwYWNlIG5hbW1vdXJ7CgkKbmFtZXNwYWNlIGRpb3R7CgkNCiAgICANCiAgICBjbGFzcyBEZXZpY2VfQ2F0ZWdvcnl7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5EZXZpY2VfQ2F0ZWdvcnkoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBfcGFyZW50Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBwYXJlbnQoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgcGFyZW50KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIHBhcmVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50X0RldmljZV9DYXRlZ29yeXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9wYXJlbnRfRGV2aWNlX0NhdGVnb3J5czsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHBhcmVudF9EZXZpY2VfQ2F0ZWdvcnlzKCk7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIHBhcmVudF9EZXZpY2VfQ2F0ZWdvcnlzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50X0RldmljZV9DYXRlZ29yeXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuY2F0ZWdvcnlfRGV2aWNlX1R5cGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfY2F0ZWdvcnlfRGV2aWNlX1R5cGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgY2F0ZWdvcnlfRGV2aWNlX1R5cGVzKCk7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIGNhdGVnb3J5X0RldmljZV9UeXBlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmNhdGVnb3J5X0RldmljZV9UeXBlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5PiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTWV0cmljX0dyb3Vwew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+TWV0cmljX0dyb3VwKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAuZ3JvdXBfTWV0cmljX1R5cGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZ3JvdXBfTWV0cmljX1R5cGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZ3JvdXBfTWV0cmljX1R5cGVzKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIGdyb3VwX01ldHJpY19UeXBlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmdyb3VwX01ldHJpY19UeXBlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgRGV2aWNlX1R5cGV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIERldmljZV9UeXBlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfkRldmljZV9UeXBlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5jYXRlZ29yeSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogX2NhdGVnb3J5Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBjYXRlZ29yeSgpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIGNhdGVnb3J5KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgY2F0ZWdvcnkoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuY2F0ZWdvcnkgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmRldmljZVR5cGVfTWV0cmljcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2RldmljZVR5cGVfTWV0cmljczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGRldmljZVR5cGVfTWV0cmljcygpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIGRldmljZVR5cGVfTWV0cmljcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuZGV2aWNlVHlwZV9NZXRyaWNzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUudHlwZV9EZXZpY2VzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdHlwZV9EZXZpY2VzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdHlwZV9EZXZpY2VzKCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgdHlwZV9EZXZpY2VzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS50eXBlX0RldmljZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5kZXZpY2VUeXBlX1R5cGVfQXR0cmlidXRlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2RldmljZVR5cGVfVHlwZV9BdHRyaWJ1dGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZGV2aWNlVHlwZV9UeXBlX0F0dHJpYnV0ZXMoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBkZXZpY2VUeXBlX1R5cGVfQXR0cmlidXRlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuZGV2aWNlVHlwZV9UeXBlX0F0dHJpYnV0ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE1ldHJpY19UeXBlew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBNZXRyaWNfVHlwZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5NZXRyaWNfVHlwZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuZ3JvdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCogZ3JvdXAoKTsNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiBncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIGdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS50eXBlX01ldHJpY3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF90eXBlX01ldHJpY3M7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB0eXBlX01ldHJpY3MoKTsNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiB0eXBlX01ldHJpY3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLnR5cGVfTWV0cmljcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZT4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgVHlwZV9BdHRyaWJ1dGV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgflR5cGVfQXR0cmlidXRlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgVHlwZV9BdHRyaWJ1dGUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgVHlwZV9BdHRyaWJ1dGUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5kZXZpY2VUeXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIF9kZXZpY2VUeXBlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIGRldmljZVR5cGUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuZGV2aWNlVHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzKCk7DQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5hdHRyaWJ1dGVfRGV2aWNlX0F0dHJpYnV0ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgVHlwZV9BdHRyaWJ1dGUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE1ldHJpY3sNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWV0cmljKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk1ldHJpYygpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTWV0cmljJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTWV0cmljJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE1ldHJpYyYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBNZXRyaWMmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTWV0cmljJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTWV0cmljJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBNZXRyaWMmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNZXRyaWMmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5zY3JpcHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3NjcmlwdDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBzY3JpcHQoKTsNCiAgICAgICAgICAgIE1ldHJpYyYgc2NyaXB0KHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpYyYgc2NyaXB0KGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMuc2NyaXB0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSogX3R5cGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSogdHlwZSgpOw0KICAgICAgICAgICAgTWV0cmljJiB0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpYyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmRldmljZVR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogX2RldmljZVR5cGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogZGV2aWNlVHlwZSgpOw0KICAgICAgICAgICAgTWV0cmljJiBkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpYyYgZGV2aWNlVHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5kZXZpY2VUeXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMubWV0cmljX01ldHJpY19WYWx1ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9tZXRyaWNfTWV0cmljX1ZhbHVlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIG1ldHJpY19NZXRyaWNfVmFsdWVzKCk7DQogICAgICAgICAgICBNZXRyaWMmIG1ldHJpY19NZXRyaWNfVmFsdWVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMubWV0cmljX01ldHJpY19WYWx1ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1ldHJpYyYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIE1ldHJpYyYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgTWV0cmljJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYz4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIERldmljZXsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfkRldmljZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgRGV2aWNlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgRGV2aWNlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIERldmljZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBEZXZpY2UmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgRGV2aWNlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgRGV2aWNlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBEZXZpY2UmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2UmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIF90eXBlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIHR5cGUoKTsNCiAgICAgICAgICAgIERldmljZSYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2UmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb250cm9sbGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX2NvbnRyb2xsZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBjb250cm9sbGVyKCk7DQogICAgICAgICAgICBEZXZpY2UmIGNvbnRyb2xsZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2UmIGNvbnRyb2xsZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb250cm9sbGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZGV2aWNlX01ldHJpY19WYWx1ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9kZXZpY2VfTWV0cmljX1ZhbHVlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGRldmljZV9NZXRyaWNfVmFsdWVzKCk7DQogICAgICAgICAgICBEZXZpY2UmIGRldmljZV9NZXRyaWNfVmFsdWVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZGV2aWNlX01ldHJpY19WYWx1ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZGV2aWNlX0RldmljZV9BdHRyaWJ1dGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZGV2aWNlX0RldmljZV9BdHRyaWJ1dGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZGV2aWNlX0RldmljZV9BdHRyaWJ1dGVzKCk7DQogICAgICAgICAgICBEZXZpY2UmIGRldmljZV9EZXZpY2VfQXR0cmlidXRlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLmRldmljZV9EZXZpY2VfQXR0cmlidXRlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgRGV2aWNlJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBEZXZpY2UmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgRGV2aWNlX0F0dHJpYnV0ZXsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5EZXZpY2VfQXR0cmlidXRlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUudmFsdWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3ZhbHVlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHZhbHVlKCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiB2YWx1ZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUudmFsdWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmRldmljZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogX2RldmljZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogZGV2aWNlKCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIGRldmljZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmRldmljZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuYXR0cmlidXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIF9hdHRyaWJ1dGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSogYXR0cmlidXRlKCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBhdHRyaWJ1dGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgYXR0cmlidXRlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5hdHRyaWJ1dGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTWV0cmljX1ZhbHVlew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+TWV0cmljX1ZhbHVlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLnZhbHVlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF92YWx1ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyB2YWx1ZSgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiB2YWx1ZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS52YWx1ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5tZWFzdXJlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX21lYXN1cmVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBtZWFzdXJlZCgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBtZWFzdXJlZCh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUubWVhc3VyZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUubWV0cmljIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljKiBfbWV0cmljOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljKiBtZXRyaWMoKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgbWV0cmljKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIG1ldHJpYyhlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUubWV0cmljIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmRldmljZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogX2RldmljZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogZGV2aWNlKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIGRldmljZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLmRldmljZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCn0KCQp9CgkKfQoJCn0KCQ0KDQpuYW1lc3BhY2UgZXNwdGVzdHsKCQ0KICAgIA0KICAgIGNsYXNzIFVzZXJ7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFVzZXIoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+VXNlcigpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIFVzZXImIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIFVzZXImIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBVc2VyJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgVXNlciYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIFVzZXImIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIFVzZXImIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgVXNlciYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIFVzZXImIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLnVzZXJuYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF91c2VybmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyB1c2VybmFtZSgpOw0KICAgICAgICAgICAgVXNlciYgdXNlcm5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLnVzZXJuYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5wYXNzd29yZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcGFzc3dvcmQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcGFzc3dvcmQoKTsNCiAgICAgICAgICAgIFVzZXImIHBhc3N3b3JkKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5wYXNzd29yZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBVc2VyJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgVXNlciYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgVXNlciYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0OjpVc2VyJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0OjpVc2VyPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0OjpVc2VyJiBmaW5kKCk7DQogICAgDQogICAgICAgIGpzb24gaW5pdCgpOw0KICAgIA0KICAgIH07DQogICAgDQp9CgkNCg0KLyoqKioqKioqKioqKiogSGVhZGVyIEZpbGUgRU5EICoqKioqKioqKioqKioqKioqKioqKiovDQoNCg0Kc3RhdGljIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdGhpc05vZGUgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSgpKS0+Y29kZSgiYWJjIikuYWN0aXZlKHRydWUpLmVuYWJsZWQodHJ1ZSk7DQoNCg0KICAgIA0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6VXNlcjo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OlVzZXI6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6VXNlcjo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6VXNlcjo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6VXNlcjo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0OjpVc2VyOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0OjpVc2VyOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6dXNlcm5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3VzZXJuYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OlVzZXI6OnVzZXJuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl91c2VybmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6cGFzc3dvcmQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3Bhc3N3b3JkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OlVzZXI6OnBhc3N3b3JkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXNzd29yZDsNCn0NCiAgICANCg0KICAgIA0KDQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlVzZXI6Ol91bmlxdWUoKTogIjsNCg0KICAgIFVzZXIqIHJldCA9IG5ldyBVc2VyKCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT51c2VybmFtZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPnVzZXJuYW1lKHRoaXMtPnVzZXJuYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAganNvbiBkYXRhID0ganNvbjo6cGFyc2Uob2JqKTsNCiAgICANCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OlVzZXI6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVXNlcjo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlVzZXIuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIlVzZXIiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0OjpVc2VyKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6VXNlcj4mIGVzcHRlc3Q6OlVzZXI6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlVzZXI6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlVzZXIuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJVc2VyIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6VXNlcj4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlVzZXI6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlVzZXIuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJVc2VyIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6VXNlciogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmpzb24gZXNwdGVzdDo6VXNlcjo6aW5pdCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVXNlcjo6aW5pdCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVXNlci5pbml0KCkiKS5tZXRob2QoImluaXQiKS5jbGFzc05hbWUoIlVzZXIiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBqc29uIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCgoc3RkOjpzdHJpbmcpYW5zd2VyKTsNCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiBhbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpzY3JpcHQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3NjcmlwdCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpzY3JpcHQoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9zY3JpcHQNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpzY3JpcHQoKXsNCiAgICByZXR1cm4gdGhpcy0+X3NjcmlwdDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIHYpew0KICAgIHRoaXMtPl90eXBlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fdHlwZSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OnR5cGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X3R5cGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6ZGV2aWNlVHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiB2KXsNCiAgICB0aGlzLT5fZGV2aWNlVHlwZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6ZGV2aWNlVHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2RldmljZVR5cGUgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpkZXZpY2VUeXBlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kZXZpY2VUeXBlOw0KfQ0KICAgIA0KDQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6bWV0cmljX01ldHJpY19WYWx1ZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9tZXRyaWNfTWV0cmljX1ZhbHVlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Om1ldHJpY19NZXRyaWNfVmFsdWVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpYzo6X3VuaXF1ZSgpOiAiOw0KDQogICAgTWV0cmljKiByZXQgPSBuZXcgTWV0cmljKCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGpzb24gZGF0YSA9IGpzb246OnBhcnNlKG9iaik7DQogICAgDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpYzo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1ldHJpYy5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTWV0cmljIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYz4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWM6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1ldHJpYy5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk1ldHJpYyIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWM6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1ldHJpYy5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk1ldHJpYyIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6dmFsdWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3ZhbHVlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjp2YWx1ZSgpew0KICAgIHJldHVybiB0aGlzLT5fdmFsdWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6bWVhc3VyZWQodGltZV90IHYpew0KICAgIHRoaXMtPl9tZWFzdXJlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om1lYXN1cmVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9tZWFzdXJlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjptZXRyaWMoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIHYpew0KICAgIHRoaXMtPl9tZXRyaWMgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om1ldHJpYyhlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9tZXRyaWMgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6bWV0cmljKCl7DQogICAgcmV0dXJuIHRoaXMtPl9tZXRyaWM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZGV2aWNlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiB2KXsNCiAgICB0aGlzLT5fZGV2aWNlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fZGV2aWNlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmRldmljZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGV2aWNlOw0KfQ0KICAgIA0KDQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWNfVmFsdWU6Ol91bmlxdWUoKTogIjsNCg0KICAgIE1ldHJpY19WYWx1ZSogcmV0ID0gbmV3IE1ldHJpY19WYWx1ZSgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+bWV0cmljKCkhPW51bGxwdHIpDQogICAgICAgIA0KICAgICAgICByZXQtPm1ldHJpYyh0aGlzLT5tZXRyaWMoKS0+X3VuaXF1ZSgpKTsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+ZGV2aWNlKCkhPW51bGxwdHIpDQogICAgICAgIA0KICAgICAgICByZXQtPmRldmljZSh0aGlzLT5kZXZpY2UoKS0+X3VuaXF1ZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWNfVmFsdWU6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVmFsdWUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk1ldHJpY19WYWx1ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1ZhbHVlOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVmFsdWUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJNZXRyaWNfVmFsdWUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1ZhbHVlOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVmFsdWUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJNZXRyaWNfVmFsdWUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgdil7DQogICAgdGhpcy0+X3R5cGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90eXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6dHlwZSgpew0KICAgIHJldHVybiB0aGlzLT5fdHlwZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpjb250cm9sbGVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X2NvbnRyb2xsZXIgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmNvbnRyb2xsZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2NvbnRyb2xsZXIgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmNvbnRyb2xsZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvbnRyb2xsZXI7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpkZXZpY2VfTWV0cmljX1ZhbHVlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2RldmljZV9NZXRyaWNfVmFsdWVzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZGV2aWNlX01ldHJpY19WYWx1ZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmRldmljZV9EZXZpY2VfQXR0cmlidXRlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2RldmljZV9EZXZpY2VfQXR0cmlidXRlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmRldmljZV9EZXZpY2VfQXR0cmlidXRlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2U6Ol91bmlxdWUoKTogIjsNCg0KICAgIERldmljZSogcmV0ID0gbmV3IERldmljZSgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2U6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2Uuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkRldmljZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2UuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJEZXZpY2UiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2UuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJEZXZpY2UiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjp2YWx1ZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fdmFsdWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjp2YWx1ZSgpew0KICAgIHJldHVybiB0aGlzLT5fdmFsdWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIHYpew0KICAgIHRoaXMtPl9kZXZpY2UgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6ZGV2aWNlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2RldmljZSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6ZGV2aWNlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kZXZpY2U7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjphdHRyaWJ1dGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgdil7DQogICAgdGhpcy0+X2F0dHJpYnV0ZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjphdHRyaWJ1dGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9hdHRyaWJ1dGUgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6YXR0cmlidXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hdHRyaWJ1dGU7DQp9DQogICAgDQoNCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX0F0dHJpYnV0ZTo6X3VuaXF1ZSgpOiAiOw0KDQogICAgRGV2aWNlX0F0dHJpYnV0ZSogcmV0ID0gbmV3IERldmljZV9BdHRyaWJ1dGUoKTsNCiAgICAvL2lmKHRoaXMuSWQpIHJldC5JZCA9IHRoaXMuSWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmRldmljZSgpIT1udWxscHRyKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5kZXZpY2UodGhpcy0+ZGV2aWNlKCktPl91bmlxdWUoKSk7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmF0dHJpYnV0ZSgpIT1udWxscHRyKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5hdHRyaWJ1dGUodGhpcy0+YXR0cmlidXRlKCktPl91bmlxdWUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGpzb24gZGF0YSA9IGpzb246OnBhcnNlKG9iaik7DQogICAgDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9BdHRyaWJ1dGU6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2VfQXR0cmlidXRlLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJEZXZpY2VfQXR0cmlidXRlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfQXR0cmlidXRlOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2VfQXR0cmlidXRlLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiRGV2aWNlX0F0dHJpYnV0ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfQXR0cmlidXRlOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2VfQXR0cmlidXRlLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiRGV2aWNlX0F0dHJpYnV0ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6ZGV2aWNlVHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiB2KXsNCiAgICB0aGlzLT5fZGV2aWNlVHlwZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmRldmljZVR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9kZXZpY2VUeXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpkZXZpY2VUeXBlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kZXZpY2VUeXBlOw0KfQ0KICAgIA0KDQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjphdHRyaWJ1dGVfRGV2aWNlX0F0dHJpYnV0ZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9hdHRyaWJ1dGVfRGV2aWNlX0F0dHJpYnV0ZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6YXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUeXBlX0F0dHJpYnV0ZTo6X3VuaXF1ZSgpOiAiOw0KDQogICAgVHlwZV9BdHRyaWJ1dGUqIHJldCA9IG5ldyBUeXBlX0F0dHJpYnV0ZSgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+ZGV2aWNlVHlwZSgpIT1udWxscHRyKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5kZXZpY2VUeXBlKHRoaXMtPmRldmljZVR5cGUoKS0+X3VuaXF1ZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHN0ZDo6c3RyaW5nIHNPYmogPSBzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApOw0KICAgIHRoaXMtPl9mcm9tRG9jdW1lbnQoc09iaik7DQogICAgZGVsZXRlIHNPYmo7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGpzb24gZGF0YSA9IGpzb246OnBhcnNlKG9iaik7DQogICAgDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlR5cGVfQXR0cmlidXRlOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVHlwZV9BdHRyaWJ1dGUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIlR5cGVfQXR0cmlidXRlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUeXBlX0F0dHJpYnV0ZTo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVHlwZV9BdHRyaWJ1dGUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJUeXBlX0F0dHJpYnV0ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUeXBlX0F0dHJpYnV0ZTo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVHlwZV9BdHRyaWJ1dGUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJUeXBlX0F0dHJpYnV0ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIHYpew0KICAgIHRoaXMtPl9wYXJlbnQgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OnBhcmVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9wYXJlbnQgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6cGFyZW50KCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXJlbnQ7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpwYXJlbnRfRGV2aWNlX0NhdGVnb3J5cygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3BhcmVudF9EZXZpY2VfQ2F0ZWdvcnlzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6cGFyZW50X0RldmljZV9DYXRlZ29yeXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNhdGVnb3J5X0RldmljZV9UeXBlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2NhdGVnb3J5X0RldmljZV9UeXBlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNhdGVnb3J5X0RldmljZV9UeXBlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfQ2F0ZWdvcnk6Ol91bmlxdWUoKTogIjsNCg0KICAgIERldmljZV9DYXRlZ29yeSogcmV0ID0gbmV3IERldmljZV9DYXRlZ29yeSgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfQ2F0ZWdvcnk6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2VfQ2F0ZWdvcnkuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkRldmljZV9DYXRlZ29yeSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX0NhdGVnb3J5OjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2VfQ2F0ZWdvcnkuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJEZXZpY2VfQ2F0ZWdvcnkiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX0NhdGVnb3J5OjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5EZXZpY2VfQ2F0ZWdvcnkuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJEZXZpY2VfQ2F0ZWdvcnkiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6Y2F0ZWdvcnkoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIHYpew0KICAgIHRoaXMtPl9jYXRlZ29yeSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmNhdGVnb3J5KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2NhdGVnb3J5ID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6Y2F0ZWdvcnkoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NhdGVnb3J5Ow0KfQ0KICAgIA0KDQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpkZXZpY2VUeXBlX01ldHJpY3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9kZXZpY2VUeXBlX01ldHJpY3MpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZGV2aWNlVHlwZV9NZXRyaWNzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OnR5cGVfRGV2aWNlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3R5cGVfRGV2aWNlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjp0eXBlX0RldmljZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZGV2aWNlVHlwZV9UeXBlX0F0dHJpYnV0ZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9kZXZpY2VUeXBlX1R5cGVfQXR0cmlidXRlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpkZXZpY2VUeXBlX1R5cGVfQXR0cmlidXRlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX1R5cGU6Ol91bmlxdWUoKTogIjsNCg0KICAgIERldmljZV9UeXBlKiByZXQgPSBuZXcgRGV2aWNlX1R5cGUoKTsNCiAgICAvL2lmKHRoaXMuSWQpIHJldC5JZCA9IHRoaXMuSWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfVHlwZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkRldmljZV9UeXBlLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJEZXZpY2VfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX1R5cGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkRldmljZV9UeXBlLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiRGV2aWNlX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX1R5cGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkRldmljZV9UeXBlLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiRGV2aWNlX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpncm91cF9NZXRyaWNfVHlwZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9ncm91cF9NZXRyaWNfVHlwZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpncm91cF9NZXRyaWNfVHlwZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX0dyb3VwOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBNZXRyaWNfR3JvdXAqIHJldCA9IG5ldyBNZXRyaWNfR3JvdXAoKTsNCiAgICAvL2lmKHRoaXMuSWQpIHJldC5JZCA9IHRoaXMuSWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHN0ZDo6c3RyaW5nIHNPYmogPSBzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApOw0KICAgIHRoaXMtPl9mcm9tRG9jdW1lbnQoc09iaik7DQogICAgZGVsZXRlIHNPYmo7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAganNvbiBkYXRhID0ganNvbjo6cGFyc2Uob2JqKTsNCiAgICANCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX0dyb3VwOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljX0dyb3VwLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJNZXRyaWNfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19Hcm91cDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljX0dyb3VwLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiTWV0cmljX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19Hcm91cDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljX0dyb3VwLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiTWV0cmljX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Omdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiB2KXsNCiAgICB0aGlzLT5fZ3JvdXAgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9ncm91cCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Omdyb3VwKCl7DQogICAgcmV0dXJuIHRoaXMtPl9ncm91cDsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6dHlwZV9NZXRyaWNzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fdHlwZV9NZXRyaWNzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OnR5cGVfTWV0cmljcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1R5cGU6Ol91bmlxdWUoKTogIjsNCg0KICAgIE1ldHJpY19UeXBlKiByZXQgPSBuZXcgTWV0cmljX1R5cGUoKTsNCiAgICAvL2lmKHRoaXMuSWQpIHJldC5JZCA9IHRoaXMuSWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWNfVHlwZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1ldHJpY19UeXBlLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJNZXRyaWNfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1R5cGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1ldHJpY19UeXBlLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiTWV0cmljX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1R5cGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1ldHJpY19UeXBlLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiTWV0cmljX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dmFsdWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3ZhbHVlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnZhbHVlKGpzb24gdil7DQogICAgLy90aGlzLT5fdmFsdWUNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjp2YWx1ZSgpew0KICAgIHJldHVybiB0aGlzLT5fdmFsdWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6c2NyaXB0KHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9zY3JpcHQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6c2NyaXB0KGpzb24gdil7DQogICAgLy90aGlzLT5fc2NyaXB0DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6c2NyaXB0KCl7DQogICAgcmV0dXJuIHRoaXMtPl9zY3JpcHQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIHYpew0KICAgIHRoaXMtPl90b29sID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjp0b29sKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90b29sID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjp0b29sKCl7DQogICAgcmV0dXJuIHRoaXMtPl90b29sOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Omdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiB2KXsNCiAgICB0aGlzLT5fZ3JvdXAgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Omdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2dyb3VwID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Omdyb3VwKCl7DQogICAgcmV0dXJuIHRoaXMtPl9ncm91cDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiB2KXsNCiAgICB0aGlzLT5fdHlwZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90eXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnR5cGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X3R5cGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6bm9kZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHYpew0KICAgIHRoaXMtPl9ub2RlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpub2RlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9ub2RlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpub2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9ub2RlOw0KfQ0KICAgIA0KDQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWc6Ol91bmlxdWUoKTogIjsNCg0KICAgIENvbmZpZyogcmV0ID0gbmV3IENvbmZpZygpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+bmFtZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPm5hbWUodGhpcy0+bmFtZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWc6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Db25maWcuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkNvbmZpZyIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiQ29uZmlnOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Db25maWcuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJDb25maWciKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZz4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiQ29uZmlnOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Db25maWcuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJDb25maWciKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiB2KXsNCiAgICB0aGlzLT5fdHlwZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3R5cGUgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnR5cGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X3R5cGU7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6dG9vbF9Db25maWdzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fdG9vbF9Db25maWdzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjp0b29sX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjp0b29sX01hcHBpbmdzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fdG9vbF9NYXBwaW5ncykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6dG9vbF9NYXBwaW5ncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlRvb2w6Ol91bmlxdWUoKTogIjsNCg0KICAgIFRvb2wqIHJldCA9IG5ldyBUb29sKCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHN0ZDo6c3RyaW5nIHNPYmogPSBzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApOw0KICAgIHRoaXMtPl9mcm9tRG9jdW1lbnQoc09iaik7DQogICAgZGVsZXRlIHNPYmo7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUb29sOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVG9vbC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiVG9vbCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVG9vbDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVG9vbC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIlRvb2wiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVG9vbDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVG9vbC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIlRvb2wiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Omdyb3VwX0NvbmZpZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9ncm91cF9Db25maWdzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6Z3JvdXBfQ29uZmlncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6Z3JvdXBfTWFwcGluZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9ncm91cF9NYXBwaW5ncykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Omdyb3VwX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkNvbmZpZ19Hcm91cDo6X3VuaXF1ZSgpOiAiOw0KDQogICAgQ29uZmlnX0dyb3VwKiByZXQgPSBuZXcgQ29uZmlnX0dyb3VwKCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGpzb24gZGF0YSA9IGpzb246OnBhcnNlKG9iaik7DQogICAgDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkNvbmZpZ19Hcm91cDo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkNvbmZpZ19Hcm91cC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiQ29uZmlnX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWdfR3JvdXA6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkNvbmZpZ19Hcm91cC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIkNvbmZpZ19Hcm91cCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWdfR3JvdXA6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkNvbmZpZ19Hcm91cC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIkNvbmZpZ19Hcm91cCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNYXBwaW5nX0dyb3VwOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBNYXBwaW5nX0dyb3VwKiByZXQgPSBuZXcgTWFwcGluZ19Hcm91cCgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAganNvbiBkYXRhID0ganNvbjo6cGFyc2Uob2JqKTsNCiAgICANCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWFwcGluZ19Hcm91cDo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmdfR3JvdXAuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk1hcHBpbmdfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmdfR3JvdXA6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmdfR3JvdXAuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJNYXBwaW5nX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmdfR3JvdXA6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmdfR3JvdXAuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJNYXBwaW5nX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjp0eXBlX0NvbmZpZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl90eXBlX0NvbmZpZ3MpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjp0eXBlX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OnR5cGVfVG9vbHMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl90eXBlX1Rvb2xzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6dHlwZV9Ub29scyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6dHlwZV9NYXBwaW5ncygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3R5cGVfTWFwcGluZ3MpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjp0eXBlX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlRvb2xfVHlwZTo6X3VuaXF1ZSgpOiAiOw0KDQogICAgVG9vbF9UeXBlKiByZXQgPSBuZXcgVG9vbF9UeXBlKCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGpzb24gZGF0YSA9IGpzb246OnBhcnNlKG9iaik7DQogICAgDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlRvb2xfVHlwZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlRvb2xfVHlwZS5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiVG9vbF9UeXBlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZT4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUb29sX1R5cGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlRvb2xfVHlwZS5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIlRvb2xfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUb29sX1R5cGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlRvb2xfVHlwZS5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIlRvb2xfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50Ojpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjbGFzc05hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NsYXNzTmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjbGFzc05hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NsYXNzTmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6bWV0aG9kKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9tZXRob2QgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6bWV0aG9kKCl7DQogICAgcmV0dXJuIHRoaXMtPl9tZXRob2Q7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnBheWxvYWQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3BheWxvYWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnBheWxvYWQoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9wYXlsb2FkDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpwYXlsb2FkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXlsb2FkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjYXJyaWVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X2NhcnJpZXIgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjYXJyaWVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9jYXJyaWVyID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmNhcnJpZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NhcnJpZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnNlbmRlcihlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHYpew0KICAgIHRoaXMtPl9zZW5kZXIgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpzZW5kZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3NlbmRlciA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpzZW5kZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X3NlbmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cmVjaXBpZW50KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X3JlY2lwaWVudCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlY2lwaWVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fcmVjaXBpZW50ID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlY2lwaWVudCgpew0KICAgIHJldHVybiB0aGlzLT5fcmVjaXBpZW50Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpyZXNwb25zZVRvKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIHYpew0KICAgIHRoaXMtPl9yZXNwb25zZVRvID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cmVzcG9uc2VUbyhlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3Jlc3BvbnNlVG8gPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlc3BvbnNlVG8oKXsNCiAgICByZXR1cm4gdGhpcy0+X3Jlc3BvbnNlVG87DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlc3BvbnNlVG9fRXZlbnRzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fcmVzcG9uc2VUb19FdmVudHMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cmVzcG9uc2VUb19FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkV2ZW50OjpfdW5pcXVlKCk6ICI7DQoNCiAgICBFdmVudCogcmV0ID0gbmV3IEV2ZW50KCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAganNvbiBkYXRhID0ganNvbjo6cGFyc2Uob2JqKTsNCiAgICANCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRXZlbnQ6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5FdmVudC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiRXZlbnQiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkV2ZW50OjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5FdmVudC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIkV2ZW50IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudD4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkV2ZW50OjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5FdmVudC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIkV2ZW50IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmpzb24gZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6bGlzdGVuKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgbm9kZSl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJFdmVudDo6bGlzdGVuKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5FdmVudC5saXN0ZW4oKSIpLm1ldGhvZCgibGlzdGVuIikuY2xhc3NOYW1lKCJFdmVudCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGpzb24gYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKChzdGQ6OnN0cmluZylhbnN3ZXIpOw0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuIGFuc3dlcjsNCn0NCiAgICANCmpzb24gZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6dHJpZ2dlcigpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRXZlbnQ6OnRyaWdnZXIoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkV2ZW50LnRyaWdnZXIoKSIpLm1ldGhvZCgidHJpZ2dlciIpLmNsYXNzTmFtZSgiRXZlbnQiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBqc29uIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCgoc3RkOjpzdHJpbmcpYW5zd2VyKTsNCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiBhbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50Ojpwcm9jZXNzKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJFdmVudDo6cHJvY2VzcygpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRXZlbnQucHJvY2VzcygpIikubWV0aG9kKCJwcm9jZXNzIikuY2xhc3NOYW1lKCJFdmVudCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6YWRkcmVzcyhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fYWRkcmVzcyA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmFkZHJlc3MoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FkZHJlc3M7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpiYWNrdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KXsNCiAgICB0aGlzLT5fYmFja3VwID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmJhY2t1cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fYmFja3VwID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6YmFja3VwKCl7DQogICAgcmV0dXJuIHRoaXMtPl9iYWNrdXA7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KXsNCiAgICB0aGlzLT5fcGFyZW50ID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnBhcmVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fcGFyZW50ID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cGFyZW50KCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXJlbnQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIHYpew0KICAgIHRoaXMtPl9ncm91cCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fZ3JvdXAgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpncm91cCgpew0KICAgIHJldHVybiB0aGlzLT5fZ3JvdXA7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjb250ZXh0KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiB2KXsNCiAgICB0aGlzLT5fY29udGV4dCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjb250ZXh0KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0KiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2NvbnRleHQgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0KiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmNvbnRleHQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvbnRleHQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpwb3J0KGludCB2KXsNCiAgICB0aGlzLT5fcG9ydCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpwb3J0KCl7DQogICAgcmV0dXJuIHRoaXMtPl9wb3J0Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6b25saW5lKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fb25saW5lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Om9ubGluZSgpew0KICAgIHJldHVybiB0aGlzLT5fb25saW5lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6c2VjdXJlKGJvb2wgdil7DQogICAgdGhpcy0+X3NlY3VyZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6c2VjdXJlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9zZWN1cmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiB2KXsNCiAgICB0aGlzLT5fdHlwZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjp0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3R5cGUgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnR5cGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X3R5cGU7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Y29udHJvbGxlcl9EZXZpY2VzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fY29udHJvbGxlcl9EZXZpY2VzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjb250cm9sbGVyX0RldmljZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpub2RlX0NvbmZpZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9ub2RlX0NvbmZpZ3MpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Om5vZGVfQ29uZmlncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmNhcnJpZXJfRXZlbnRzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fY2Fycmllcl9FdmVudHMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmNhcnJpZXJfRXZlbnRzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6c2VuZGVyX0V2ZW50cygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3NlbmRlcl9FdmVudHMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnNlbmRlcl9FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpyZWNpcGllbnRfRXZlbnRzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fcmVjaXBpZW50X0V2ZW50cykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cmVjaXBpZW50X0V2ZW50cyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmJhY2t1cF9Ob2Rlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2JhY2t1cF9Ob2RlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6YmFja3VwX05vZGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cGFyZW50X05vZGVzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fcGFyZW50X05vZGVzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpwYXJlbnRfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBOb2RlKiByZXQgPSBuZXcgTm9kZSgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAganNvbiBkYXRhID0ganNvbjo6cGFyc2Uob2JqKTsNCiAgICANCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk5vZGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJOb2RlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJOb2RlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KanNvbiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmF1dGhDb2RlKHN0ZDo6c3RyaW5nIGNvZGUsIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgdG9vbCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlOjphdXRoQ29kZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZS5hdXRoQ29kZSgpIikubWV0aG9kKCJhdXRoQ29kZSIpLmNsYXNzTmFtZSgiTm9kZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGpzb24gYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKChzdGQ6OnN0cmluZylhbnN3ZXIpOw0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuIGFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjppbml0KGludCBvbmxpbmUsIHN0ZDo6c3RyaW5nIGNvZGUsIHN0ZDo6c3RyaW5nIHVpZCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlOjppbml0KCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Ob2RlLmluaXQoKSIpLm1ldGhvZCgiaW5pdCIpLmNsYXNzTmFtZSgiTm9kZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6Y29udGV4dF9Ob2Rlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2NvbnRleHRfTm9kZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0Ojpjb250ZXh0X05vZGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfQ29udGV4dDo6X3VuaXF1ZSgpOiAiOw0KDQogICAgTm9kZV9Db250ZXh0KiByZXQgPSBuZXcgTm9kZV9Db250ZXh0KCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGpzb24gZGF0YSA9IGpzb246OnBhcnNlKG9iaik7DQogICAgDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfQ29udGV4dDo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfQ29udGV4dC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTm9kZV9Db250ZXh0IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX0NvbnRleHQ6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfQ29udGV4dC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk5vZGVfQ29udGV4dCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0PiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX0NvbnRleHQ6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfQ29udGV4dC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk5vZGVfQ29udGV4dCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpncm91cF9Ob2Rlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2dyb3VwX05vZGVzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpncm91cF9Ob2RlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfR3JvdXA6Ol91bmlxdWUoKTogIjsNCg0KICAgIE5vZGVfR3JvdXAqIHJldCA9IG5ldyBOb2RlX0dyb3VwKCk7DQogICAgLy9pZih0aGlzLklkKSByZXQuSWQgPSB0aGlzLklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHN0ZDo6c3RyaW5nIHNPYmogPSBzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApOw0KICAgIHRoaXMtPl9mcm9tRG9jdW1lbnQoc09iaik7DQogICAgZGVsZXRlIHNPYmo7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX0dyb3VwOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZV9Hcm91cC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTm9kZV9Hcm91cCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9Hcm91cDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZV9Hcm91cC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk5vZGVfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9Hcm91cDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZV9Hcm91cC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk5vZGVfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpkeW5hbWljKGJvb2wgdil7DQogICAgdGhpcy0+X2R5bmFtaWMgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6ZHluYW1pYygpew0KICAgIHJldHVybiB0aGlzLT5fZHluYW1pYzsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OnR5cGVfTm9kZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl90eXBlX05vZGVzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6dHlwZV9Ob2RlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX1R5cGU6Ol91bmlxdWUoKTogIjsNCg0KICAgIE5vZGVfVHlwZSogcmV0ID0gbmV3IE5vZGVfVHlwZSgpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+bmFtZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPm5hbWUodGhpcy0+bmFtZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgc3RkOjpzdHJpbmcgc09iaiA9IHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICk7DQogICAgdGhpcy0+X2Zyb21Eb2N1bWVudChzT2JqKTsNCiAgICBkZWxldGUgc09iajsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBqc29uIGRhdGEgPSBqc29uOjpwYXJzZShvYmopOw0KICAgIA0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX1R5cGU6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Ob2RlX1R5cGUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk5vZGVfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9UeXBlOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Ob2RlX1R5cGUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJOb2RlX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9UeXBlOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Ob2RlX1R5cGUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJOb2RlX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmNsYXNzTmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY2xhc3NOYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6Y2xhc3NOYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jbGFzc05hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpzY29wZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fc2NvcGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpzY29wZSgpew0KICAgIHJldHVybiB0aGlzLT5fc2NvcGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpjb250ZXh0KHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb250ZXh0ID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6Y29udGV4dCgpew0KICAgIHJldHVybiB0aGlzLT5fY29udGV4dDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnNvdXJjZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fc291cmNlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6c291cmNlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9zb3VyY2U7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjp0YXJnZXQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3RhcmdldCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnRhcmdldCgpew0KICAgIHJldHVybiB0aGlzLT5fdGFyZ2V0Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6aW5TY3JpcHQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2luU2NyaXB0ID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6aW5TY3JpcHQoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9pblNjcmlwdA0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjppblNjcmlwdCgpew0KICAgIHJldHVybiB0aGlzLT5faW5TY3JpcHQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpvdXRTY3JpcHQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X291dFNjcmlwdCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Om91dFNjcmlwdChqc29uIHYpew0KICAgIC8vdGhpcy0+X291dFNjcmlwdA0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpvdXRTY3JpcHQoKXsNCiAgICByZXR1cm4gdGhpcy0+X291dFNjcmlwdDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnRvb2woZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiB2KXsNCiAgICB0aGlzLT5fdG9vbCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjp0b29sKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90b29sID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6dG9vbCgpew0KICAgIHJldHVybiB0aGlzLT5fdG9vbDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Omdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiB2KXsNCiAgICB0aGlzLT5fZ3JvdXAgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6Z3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fZ3JvdXAgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Omdyb3VwKCl7DQogICAgcmV0dXJuIHRoaXMtPl9ncm91cDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIHYpew0KICAgIHRoaXMtPl90eXBlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fdHlwZSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6dHlwZSgpew0KICAgIHJldHVybiB0aGlzLT5fdHlwZTsNCn0NCiAgICANCg0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNYXBwaW5nOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBNYXBwaW5nKiByZXQgPSBuZXcgTWFwcGluZygpOw0KICAgIC8vaWYodGhpcy5JZCkgcmV0LklkID0gdGhpcy5JZDsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICBzdGQ6OnN0cmluZyBzT2JqID0gc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKTsNCiAgICB0aGlzLT5fZnJvbURvY3VtZW50KHNPYmopOw0KICAgIGRlbGV0ZSBzT2JqOw0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAganNvbiBkYXRhID0ganNvbjo6cGFyc2Uob2JqKTsNCiAgICANCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWFwcGluZzo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmcuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk1hcHBpbmciKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmc6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmcuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJNYXBwaW5nIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmc6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmcuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJNYXBwaW5nIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyKiBhcmd2W10pIHsNCg0KICAgIGNvbnN0IHN0ZDo6c3RyaW5nIFNFUlZFUl9BRERSRVNTKCJtcXR0Oi8vdGVzdC5tb3NxdWl0dG8ub3JnOjE4ODMiKTsNCiAgICBtcXR0Ojphc3luY19jbGllbnQgY2xpKFNFUlZFUl9BRERSRVNTLCAiIiwgbXF0dDo6Y3JlYXRlX29wdGlvbnMoTVFUVFZFUlNJT05fNSkpOw0KICAgIGNsaS5zZXRfbWVzc2FnZV9jYWxsYmFjayhbXShtcXR0Ojpjb25zdF9tZXNzYWdlX3B0ciBtc2cpIHsgKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5fZnJvbURvY3VtZW50KG1zZy5nZXRfcGF5bG9hZF9zdHIoKSkucHJvY2VzcygpOyB9KTsNCiAgICBhdXRvIHRvayA9IGNsaS5jb25uZWN0KG1xdHQ6OmNvbm5lY3Rfb3B0aW9uc19idWlsZGVyKCkNCgkJLnByb3BlcnRpZXMoew0KCQkJe21xdHQ6OnByb3BlcnR5OjpTRVNTSU9OX0VYUElSWV9JTlRFUlZBTCwgNjA0ODAwfQ0KCQl9KQ0KCQkuY2xlYW5fc3RhcnQoZmFsc2UpDQoJCS8vLndpbGwoc3RkOjptb3ZlKGx3dCkpDQoJCS5rZWVwX2FsaXZlX2ludGVydmFsKHN0ZDo6Y2hyb25vOjpzZWNvbmRzKDIwKSkNCgkJLmZpbmFsaXplKCkpOw0KICAgIHRvay53YWl0KCk7DQoNCiAgICByZXR1cm4gMDsNCn0=",
	"__keys": ["name"],
	"__trMap": []
}