{
	"Id": "d16d88fd13d3bdf64f7de272a7720714de5be28b",
	"active": "true",
	"enabled": "true",
	"code": "c++",
	"date": "2024-10-21T02:25:35.491Z",
	"name": "C++",
	"remark": "LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoqKioqKioqKioqKioqKioqKioqKiAgICAgICAgQVBJIFNlcnZlciBTdHViIGZvciBDKysgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioNCioqKioqKioqKioqKioqKioqKioqIFZFUlNJT046IDIwMjQtMTAtMjFUMDI6MjU6MzQuNjk4WiAgKioqKioqKioqKioqKioqKioqKioNCioqKioqKioqKioqKioqKioqKioqICBTWVNURU06IGFwaXNlcnZlci9lc3B0ZXN0ICAgICAqKioqKioqKioqKioqKioqKioqKg0KKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovDQoNCg0KDQovKiBMaW51eCBydW5uZXI6DQp3Z2V0IC1xTy0gImh0dHBzOi8vYXJ6aG9zcGl0YWwuZ2l0aHViLmlvL2VzcHRlc3QvTm9kZV9UeXBlL0MrKy5qc29uIiB8IGpxIC1yICcucmVtYXJrIHwgQGJhc2U2NGQnIHwgZysrIC14IGMrKyAtDQoNCg0KKi8NCg0KDQojaW5jbHVkZSA8Y3RpbWU+DQojaW5jbHVkZSA8c3RyaW5nPg0KI2luY2x1ZGUgImJpdHMvc3RkYysrLmgiDQojaW5jbHVkZSA8Y2hyb25vPg0KI2luY2x1ZGUgImluY2x1ZGUvanNvbi5ocHAiDQojaW5jbHVkZSAibXF0dC9hc3luY19jbGllbnQuaCINCiNpbmNsdWRlICJtcXR0L3RvcGljLmgiDQojaW5jbHVkZSA8cmVnZXg+DQojaW5jbHVkZSAiY3VybC9jdXJsLmgiDQoNCnVzaW5nIGpzb24gPSBubG9obWFubjo6anNvbjsNCg0KDQpuYW1lc3BhY2UgZXNwdGVzdHsKCQpuYW1lc3BhY2UgY29tewoJCm5hbWVzcGFjZSBuYW1tb3VyewoJCm5hbWVzcGFjZSBkY29tewoJDQogICAgDQogICAgY2xhc3MgQ29uZmlnX0dyb3Vwew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBDb25maWdfR3JvdXAoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+Q29uZmlnX0dyb3VwKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgQ29uZmlnX0dyb3VwJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgQ29uZmlnX0dyb3VwJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgQ29uZmlnX0dyb3VwJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZ19Hcm91cC5ncm91cF9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZ3JvdXBfQ29uZmlnczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGdyb3VwX0NvbmZpZ3MoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgZ3JvdXBfQ29uZmlncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnX0dyb3VwLmdyb3VwX0NvbmZpZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuZ3JvdXBfTWFwcGluZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9ncm91cF9NYXBwaW5nczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGdyb3VwX01hcHBpbmdzKCk7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIGdyb3VwX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWdfR3JvdXAuZ3JvdXBfTWFwcGluZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIENvbmZpZ19Hcm91cCYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgQ29uZmlnX0dyb3VwJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBDb25maWdfR3JvdXAmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8Q29uZmlnX0dyb3VwPiYmIF9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTWFwcGluZ19Hcm91cHsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWFwcGluZ19Hcm91cCgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5NYXBwaW5nX0dyb3VwKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nX0dyb3VwLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nX0dyb3VwLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTWFwcGluZ19Hcm91cCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE1hcHBpbmdfR3JvdXAmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nX0dyb3VwLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZ19Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE1hcHBpbmdfR3JvdXAmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmdfR3JvdXAucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1hcHBpbmdfR3JvdXAmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBNYXBwaW5nX0dyb3VwJiBfZnJvbURvY3VtZW50KGpzb24gb2JqKTsNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPE1hcHBpbmdfR3JvdXA+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cD4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBUb29sX1R5cGV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFRvb2xfVHlwZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5Ub29sX1R5cGUoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIFRvb2xfVHlwZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBUb29sX1R5cGUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBUb29sX1R5cGUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBUb29sX1R5cGUmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLnR5cGVfQ29uZmlncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3R5cGVfQ29uZmlnczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHR5cGVfQ29uZmlncygpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiB0eXBlX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS50eXBlX0NvbmZpZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUudHlwZV9Ub29scyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3R5cGVfVG9vbHM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB0eXBlX1Rvb2xzKCk7DQogICAgICAgICAgICBUb29sX1R5cGUmIHR5cGVfVG9vbHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2xfVHlwZS50eXBlX1Rvb2xzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbF9UeXBlLnR5cGVfTWFwcGluZ3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF90eXBlX01hcHBpbmdzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdHlwZV9NYXBwaW5ncygpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiB0eXBlX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sX1R5cGUudHlwZV9NYXBwaW5ncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgVG9vbF9UeXBlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgVG9vbF9UeXBlJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBUb29sX1R5cGUmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIFRvb2xfVHlwZSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxUb29sX1R5cGU+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBOb2RlX0NvbnRleHR7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5Ob2RlX0NvbnRleHQoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0Lm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfQ29udGV4dC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0Lm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0Lm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Db250ZXh0LmNvbnRleHRfTm9kZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9jb250ZXh0X05vZGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgY29udGV4dF9Ob2RlcygpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBjb250ZXh0X05vZGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0NvbnRleHQuY29udGV4dF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTm9kZV9Db250ZXh0JiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBOb2RlX0NvbnRleHQmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIE5vZGVfQ29udGV4dCYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxOb2RlX0NvbnRleHQ+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBOb2RlX0dyb3Vwew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlX0dyb3VwKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk5vZGVfR3JvdXAoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgTm9kZV9Hcm91cCYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX0dyb3VwLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgTm9kZV9Hcm91cCYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfR3JvdXAuZ3JvdXBfTm9kZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9ncm91cF9Ob2RlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGdyb3VwX05vZGVzKCk7DQogICAgICAgICAgICBOb2RlX0dyb3VwJiBncm91cF9Ob2RlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9Hcm91cC5ncm91cF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTm9kZV9Hcm91cCYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIE5vZGVfR3JvdXAmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8Tm9kZV9Hcm91cD4mJiBfZnJvbURvY3VtZW50cyhqc29uIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE5vZGVfVHlwZXsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTm9kZV9UeXBlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk5vZGVfVHlwZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB1bnNpZ25lZCBsb25nIElkOw0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTm9kZV9UeXBlJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBOb2RlX1R5cGUmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGVfVHlwZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmR5bmFtaWMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZHluYW1pYzsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGR5bmFtaWMoKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgZHluYW1pYyhib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLmR5bmFtaWMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGVfVHlwZS50eXBlX05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdHlwZV9Ob2RlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHR5cGVfTm9kZXMoKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgdHlwZV9Ob2RlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZV9UeXBlLnR5cGVfTm9kZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIE5vZGVfVHlwZSYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgTm9kZV9UeXBlJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBOb2RlX1R5cGUmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8Tm9kZV9UeXBlPiYmIF9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgVG9vbHsNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgVG9vbCgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5Ub29sKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBUb29sJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBUb29sJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgVG9vbCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIFRvb2wmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBUb29sJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBUb29sJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIFRvb2wmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBUb29sJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBfdHlwZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdHlwZSgpOw0KICAgICAgICAgICAgVG9vbCYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgVG9vbCYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUb29sLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wudG9vbF9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdG9vbF9Db25maWdzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdG9vbF9Db25maWdzKCk7DQogICAgICAgICAgICBUb29sJiB0b29sX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wudG9vbF9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVG9vbC50b29sX01hcHBpbmdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdG9vbF9NYXBwaW5nczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHRvb2xfTWFwcGluZ3MoKTsNCiAgICAgICAgICAgIFRvb2wmIHRvb2xfTWFwcGluZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIFRvb2wudG9vbF9NYXBwaW5ncyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgVG9vbCYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIFRvb2wmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIFRvb2wmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIFRvb2wmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8VG9vbD4mJiBfZnJvbURvY3VtZW50cyhqc29uIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE1hcHBpbmd7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1hcHBpbmcoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+TWFwcGluZygpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB1bnNpZ25lZCBsb25nIElkOw0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTWFwcGluZyYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTWFwcGluZyYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgTWFwcGluZyYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuY2xhc3NOYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jbGFzc05hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY2xhc3NOYW1lKCk7DQogICAgICAgICAgICBNYXBwaW5nJiBjbGFzc05hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmNsYXNzTmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuc2NvcGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3Njb3BlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHNjb3BlKCk7DQogICAgICAgICAgICBNYXBwaW5nJiBzY29wZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuc2NvcGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmNvbnRleHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvbnRleHQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29udGV4dCgpOw0KICAgICAgICAgICAgTWFwcGluZyYgY29udGV4dChzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuY29udGV4dCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuc291cmNlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9zb3VyY2U7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgc291cmNlKCk7DQogICAgICAgICAgICBNYXBwaW5nJiBzb3VyY2Uoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLnNvdXJjZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcudGFyZ2V0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90YXJnZXQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgdGFyZ2V0KCk7DQogICAgICAgICAgICBNYXBwaW5nJiB0YXJnZXQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLnRhcmdldCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuaW5TY3JpcHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2luU2NyaXB0Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGluU2NyaXB0KCk7DQogICAgICAgICAgICBNYXBwaW5nJiBpblNjcmlwdChzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNYXBwaW5nJiBpblNjcmlwdChqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy5pblNjcmlwdCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcub3V0U2NyaXB0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9vdXRTY3JpcHQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgb3V0U2NyaXB0KCk7DQogICAgICAgICAgICBNYXBwaW5nJiBvdXRTY3JpcHQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWFwcGluZyYgb3V0U2NyaXB0KGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLm91dFNjcmlwdCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcudG9vbCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIF90b29sOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogdG9vbCgpOw0KICAgICAgICAgICAgTWFwcGluZyYgdG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1hcHBpbmcmIHRvb2woZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcudG9vbCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1hcHBpbmcuZ3JvdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogZ3JvdXAoKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIGdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNYXBwaW5nJiBncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWFwcGluZy50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBfdHlwZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdHlwZSgpOw0KICAgICAgICAgICAgTWFwcGluZyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWFwcGluZyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNYXBwaW5nLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWFwcGluZyYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIE1hcHBpbmcmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8TWFwcGluZz4mJiBfZnJvbURvY3VtZW50cyhqc29uIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE5vZGV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE5vZGUoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+Tm9kZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB1bnNpZ25lZCBsb25nIElkOw0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTm9kZSYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTm9kZSYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE5vZGUmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBOb2RlJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTm9kZSYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTm9kZSYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBOb2RlJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTm9kZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuYWRkcmVzcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfYWRkcmVzczsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBhZGRyZXNzKCk7DQogICAgICAgICAgICBOb2RlJiBhZGRyZXNzKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5hZGRyZXNzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5iYWNrdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBfYmFja3VwOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogYmFja3VwKCk7DQogICAgICAgICAgICBOb2RlJiBiYWNrdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlJiBiYWNrdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuYmFja3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5wYXJlbnQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBfcGFyZW50Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogcGFyZW50KCk7DQogICAgICAgICAgICBOb2RlJiBwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBOb2RlJiBwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucGFyZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5ncm91cCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIGdyb3VwKCk7DQogICAgICAgICAgICBOb2RlJiBncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGUmIGdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5jb250ZXh0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0KiBfY29udGV4dDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCogY29udGV4dCgpOw0KICAgICAgICAgICAgTm9kZSYgY29udGV4dChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTm9kZSYgY29udGV4dChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvbnRleHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnBvcnQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9wb3J0Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBwb3J0KCk7DQogICAgICAgICAgICBOb2RlJiBwb3J0KGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucG9ydCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUub25saW5lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfb25saW5lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBvbmxpbmUoKTsNCiAgICAgICAgICAgIE5vZGUmIG9ubGluZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLm9ubGluZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuc2VjdXJlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX3NlY3VyZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIHNlY3VyZSgpOw0KICAgICAgICAgICAgTm9kZSYgc2VjdXJlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnNlY3VyZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSogX3R5cGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUqIHR5cGUoKTsNCiAgICAgICAgICAgIE5vZGUmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE5vZGUmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvbnRyb2xsZXJfRGV2aWNlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2NvbnRyb2xsZXJfRGV2aWNlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGNvbnRyb2xsZXJfRGV2aWNlcygpOw0KICAgICAgICAgICAgTm9kZSYgY29udHJvbGxlcl9EZXZpY2VzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNvbnRyb2xsZXJfRGV2aWNlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUubm9kZV9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfbm9kZV9Db25maWdzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgbm9kZV9Db25maWdzKCk7DQogICAgICAgICAgICBOb2RlJiBub2RlX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUubm9kZV9Db25maWdzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5jYXJyaWVyX0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2NhcnJpZXJfRXZlbnRzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgY2Fycmllcl9FdmVudHMoKTsNCiAgICAgICAgICAgIE5vZGUmIGNhcnJpZXJfRXZlbnRzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmNhcnJpZXJfRXZlbnRzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTm9kZS5zZW5kZXJfRXZlbnRzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfc2VuZGVyX0V2ZW50czsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHNlbmRlcl9FdmVudHMoKTsNCiAgICAgICAgICAgIE5vZGUmIHNlbmRlcl9FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUuc2VuZGVyX0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucmVjaXBpZW50X0V2ZW50cyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX3JlY2lwaWVudF9FdmVudHM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiByZWNpcGllbnRfRXZlbnRzKCk7DQogICAgICAgICAgICBOb2RlJiByZWNpcGllbnRfRXZlbnRzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLnJlY2lwaWVudF9FdmVudHMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmJhY2t1cF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2JhY2t1cF9Ob2RlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGJhY2t1cF9Ob2RlcygpOw0KICAgICAgICAgICAgTm9kZSYgYmFja3VwX05vZGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBOb2RlLmJhY2t1cF9Ob2RlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucGFyZW50X05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfcGFyZW50X05vZGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgcGFyZW50X05vZGVzKCk7DQogICAgICAgICAgICBOb2RlJiBwYXJlbnRfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE5vZGUucGFyZW50X05vZGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBOb2RlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTm9kZSYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgTm9kZSYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgICAgICAgICAgTm9kZSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxOb2RlPiYmIF9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZmluZCgpOw0KICAgIA0KICAgICAgICBqc29uIGF1dGhDb2RlKHN0ZDo6c3RyaW5nIGNvZGUsIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgdG9vbCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgaW5pdChpbnQgb25saW5lLCBzdGQ6OnN0cmluZyBjb2RlLCBzdGQ6OnN0cmluZyB1aWQpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgQ29uZmlnew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBDb25maWcoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+Q29uZmlnKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIENvbmZpZyYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIENvbmZpZyYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBDb25maWcmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgQ29uZmlnJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIENvbmZpZyYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIENvbmZpZyYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgQ29uZmlnJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgQ29uZmlnJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcudmFsdWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3ZhbHVlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHZhbHVlKCk7DQogICAgICAgICAgICBDb25maWcmIHZhbHVlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgdmFsdWUoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy52YWx1ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5zY3JpcHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3NjcmlwdDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBzY3JpcHQoKTsNCiAgICAgICAgICAgIENvbmZpZyYgc2NyaXB0KHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgc2NyaXB0KGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuc2NyaXB0IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnRvb2wgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sKiBfdG9vbDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIHRvb2woKTsNCiAgICAgICAgICAgIENvbmZpZyYgdG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgdG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnRvb2wgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcuZ3JvdXAgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIF9ncm91cDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogZ3JvdXAoKTsNCiAgICAgICAgICAgIENvbmZpZyYgZ3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgZ3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogQ29uZmlnLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIF90eXBlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiB0eXBlKCk7DQogICAgICAgICAgICBDb25maWcmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIENvbmZpZyYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBDb25maWcudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5ub2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX25vZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBub2RlKCk7DQogICAgICAgICAgICBDb25maWcmIG5vZGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBDb25maWcmIG5vZGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIENvbmZpZy5ub2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIENvbmZpZyYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIENvbmZpZyYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgQ29uZmlnJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBDb25maWcmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8Q29uZmlnPiYmIF9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgRXZlbnR7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIEV2ZW50KCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfkV2ZW50KCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgRXZlbnQmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgRXZlbnQmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIEV2ZW50JiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50Lm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBFdmVudCYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgRXZlbnQmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50Lm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgRXZlbnQmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBFdmVudCYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIEV2ZW50JiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmNsYXNzTmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY2xhc3NOYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNsYXNzTmFtZSgpOw0KICAgICAgICAgICAgRXZlbnQmIGNsYXNzTmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LmNsYXNzTmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50Lm1ldGhvZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbWV0aG9kOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG1ldGhvZCgpOw0KICAgICAgICAgICAgRXZlbnQmIG1ldGhvZChzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50Lm1ldGhvZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnBheWxvYWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3BheWxvYWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcGF5bG9hZCgpOw0KICAgICAgICAgICAgRXZlbnQmIHBheWxvYWQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRXZlbnQmIHBheWxvYWQoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnBheWxvYWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5jYXJyaWVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX2NhcnJpZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBjYXJyaWVyKCk7DQogICAgICAgICAgICBFdmVudCYgY2Fycmllcihlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIEV2ZW50JiBjYXJyaWVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5jYXJyaWVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQuc2VuZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX3NlbmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHNlbmRlcigpOw0KICAgICAgICAgICAgRXZlbnQmIHNlbmRlcihlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIEV2ZW50JiBzZW5kZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnNlbmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnJlY2lwaWVudCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIF9yZWNpcGllbnQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiByZWNpcGllbnQoKTsNCiAgICAgICAgICAgIEV2ZW50JiByZWNpcGllbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBFdmVudCYgcmVjaXBpZW50KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5yZWNpcGllbnQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBFdmVudC5yZXNwb25zZVRvIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIF9yZXNwb25zZVRvOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIHJlc3BvbnNlVG8oKTsNCiAgICAgICAgICAgIEV2ZW50JiByZXNwb25zZVRvKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIEV2ZW50JiByZXNwb25zZVRvKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucmVzcG9uc2VUbyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRXZlbnQucmVzcG9uc2VUb19FdmVudHMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9yZXNwb25zZVRvX0V2ZW50czsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHJlc3BvbnNlVG9fRXZlbnRzKCk7DQogICAgICAgICAgICBFdmVudCYgcmVzcG9uc2VUb19FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIEV2ZW50LnJlc3BvbnNlVG9fRXZlbnRzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBFdmVudCYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIEV2ZW50JiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBFdmVudCYgX2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopOw0KICAgICAgICAgICAgRXZlbnQmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8RXZlbnQ+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50PiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBmaW5kKCk7DQogICAgDQogICAgICAgIGpzb24gbGlzdGVuKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgbm9kZSk7DQogICAgDQogICAgICAgIGpzb24gdHJpZ2dlcigpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBwcm9jZXNzKCk7DQogICAgDQogICAgfTsNCiAgICANCn0KCQp9CgkKfQoJCn0KCQ0KDQpuYW1lc3BhY2UgZXNwdGVzdHsKCQpuYW1lc3BhY2UgY29tewoJCm5hbWVzcGFjZSBuYW1tb3VyewoJCm5hbWVzcGFjZSBkaW90ewoJDQogICAgDQogICAgY2xhc3MgRGV2aWNlX0NhdGVnb3J5ew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+RGV2aWNlX0NhdGVnb3J5KCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9DYXRlZ29yeS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBfcGFyZW50Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBwYXJlbnQoKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgcGFyZW50KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIHBhcmVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50X0RldmljZV9DYXRlZ29yeXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9wYXJlbnRfRGV2aWNlX0NhdGVnb3J5czsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHBhcmVudF9EZXZpY2VfQ2F0ZWdvcnlzKCk7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIHBhcmVudF9EZXZpY2VfQ2F0ZWdvcnlzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkucGFyZW50X0RldmljZV9DYXRlZ29yeXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQ2F0ZWdvcnkuY2F0ZWdvcnlfRGV2aWNlX1R5cGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfY2F0ZWdvcnlfRGV2aWNlX1R5cGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgY2F0ZWdvcnlfRGV2aWNlX1R5cGVzKCk7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIGNhdGVnb3J5X0RldmljZV9UeXBlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0NhdGVnb3J5LmNhdGVnb3J5X0RldmljZV9UeXBlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgRGV2aWNlX0NhdGVnb3J5JiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBEZXZpY2VfQ2F0ZWdvcnkmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIERldmljZV9DYXRlZ29yeSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxEZXZpY2VfQ2F0ZWdvcnk+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBNZXRyaWNfR3JvdXB7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5NZXRyaWNfR3JvdXAoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfR3JvdXAucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX0dyb3VwLmdyb3VwX01ldHJpY19UeXBlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX2dyb3VwX01ldHJpY19UeXBlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGdyb3VwX01ldHJpY19UeXBlcygpOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBncm91cF9NZXRyaWNfVHlwZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19Hcm91cC5ncm91cF9NZXRyaWNfVHlwZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCYgX3VuaXF1ZSgpOw0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3RvRG9jdW1lbnQoKTsNCiAgICAgICAgICAgIE1ldHJpY19Hcm91cCYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgTWV0cmljX0dyb3VwJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBNZXRyaWNfR3JvdXAmIF9mcm9tRG9jdW1lbnQoanNvbiBvYmopOw0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8TWV0cmljX0dyb3VwPiYmIF9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgRGV2aWNlX1R5cGV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIERldmljZV9UeXBlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfkRldmljZV9UeXBlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIERldmljZV9UeXBlJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmNhdGVnb3J5IEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBfY2F0ZWdvcnk7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkqIGNhdGVnb3J5KCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgY2F0ZWdvcnkoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIERldmljZV9UeXBlJiBjYXRlZ29yeShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5jYXRlZ29yeSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX1R5cGUuZGV2aWNlVHlwZV9NZXRyaWNzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZGV2aWNlVHlwZV9NZXRyaWNzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZGV2aWNlVHlwZV9NZXRyaWNzKCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgZGV2aWNlVHlwZV9NZXRyaWNzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5kZXZpY2VUeXBlX01ldHJpY3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS50eXBlX0RldmljZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF90eXBlX0RldmljZXM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB0eXBlX0RldmljZXMoKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiB0eXBlX0RldmljZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLnR5cGVfRGV2aWNlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9UeXBlLmRldmljZVR5cGVfVHlwZV9BdHRyaWJ1dGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZGV2aWNlVHlwZV9UeXBlX0F0dHJpYnV0ZXM7DQogICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBkZXZpY2VUeXBlX1R5cGVfQXR0cmlidXRlcygpOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIGRldmljZVR5cGVfVHlwZV9BdHRyaWJ1dGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfVHlwZS5kZXZpY2VUeXBlX1R5cGVfQXR0cmlidXRlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBEZXZpY2VfVHlwZSYgX2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopOw0KICAgICAgICAgICAgRGV2aWNlX1R5cGUmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIERldmljZV9UeXBlJiBfZnJvbURvY3VtZW50KGpzb24gb2JqKTsNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPERldmljZV9UeXBlPiYmIF9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZT4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZmluZCgpOw0KICAgIA0KICAgIH07DQogICAgDQogICAgY2xhc3MgTWV0cmljX1R5cGV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1ldHJpY19UeXBlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk1ldHJpY19UeXBlKCl7DQogICAgICAgICAgICAgICAgLy8gZm9yIGV2ZXJ5ICJuZXciIHRoZXJlIG11c3QgYmUgYSAiZGVsZXRlIg0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgSWQ7DQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiByZW1hcmsoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19UeXBlLmdyb3VwIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwKiBfZ3JvdXA7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAqIGdyb3VwKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgZ3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiBncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS5ncm91cCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1R5cGUudHlwZV9NZXRyaWNzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfdHlwZV9NZXRyaWNzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdHlwZV9NZXRyaWNzKCk7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgdHlwZV9NZXRyaWNzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVHlwZS50eXBlX01ldHJpY3MgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTWV0cmljX1R5cGUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIE1ldHJpY19UeXBlJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBNZXRyaWNfVHlwZSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxNZXRyaWNfVHlwZT4mJiBfZnJvbURvY3VtZW50cyhqc29uIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIFR5cGVfQXR0cmlidXRlew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5UeXBlX0F0dHJpYnV0ZSgpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB1bnNpZ25lZCBsb25nIElkOw0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgVHlwZV9BdHRyaWJ1dGUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFR5cGVfQXR0cmlidXRlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgVHlwZV9BdHRyaWJ1dGUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5kZXZpY2VUeXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIF9kZXZpY2VUeXBlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIGRldmljZVR5cGUoKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuZGV2aWNlVHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVHlwZV9BdHRyaWJ1dGUuYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzKCk7DQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgYXR0cmlidXRlX0RldmljZV9BdHRyaWJ1dGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBUeXBlX0F0dHJpYnV0ZS5hdHRyaWJ1dGVfRGV2aWNlX0F0dHJpYnV0ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgVHlwZV9BdHRyaWJ1dGUmIF9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKTsNCiAgICAgICAgICAgIFR5cGVfQXR0cmlidXRlJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBUeXBlX0F0dHJpYnV0ZSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxUeXBlX0F0dHJpYnV0ZT4mJiBfZnJvbURvY3VtZW50cyhqc29uIG9iaik7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGZpbmQoKTsNCiAgICANCiAgICB9Ow0KICAgIA0KICAgIGNsYXNzIE1ldHJpY3sNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWV0cmljKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfk1ldHJpYygpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB1bnNpZ25lZCBsb25nIElkOw0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfYWN0aXZlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgYWN0aXZlKCk7DQogICAgICAgICAgICBNZXRyaWMmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2VuYWJsZWQ7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBlbmFibGVkKCk7DQogICAgICAgICAgICBNZXRyaWMmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX2NvZGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgY29kZSgpOw0KICAgICAgICAgICAgTWV0cmljJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMub3JkZXIgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgaW50IF9vcmRlcjsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBpbnQgb3JkZXIoKTsNCiAgICAgICAgICAgIE1ldHJpYyYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9kYXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHRpbWVfdCBkYXRlKCk7DQogICAgICAgICAgICBNZXRyaWMmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfbmFtZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBuYW1lKCk7DQogICAgICAgICAgICBNZXRyaWMmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3JlbWFyazsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyByZW1hcmsoKTsNCiAgICAgICAgICAgIE1ldHJpYyYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpYyYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLnNjcmlwdCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfc2NyaXB0Ow0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHNjcmlwdCgpOw0KICAgICAgICAgICAgTWV0cmljJiBzY3JpcHQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljJiBzY3JpcHQoanNvbiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5zY3JpcHQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlKiBfdHlwZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlKiB0eXBlKCk7DQogICAgICAgICAgICBNZXRyaWMmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljJiB0eXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLnR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWMuZGV2aWNlVHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBfZGV2aWNlVHlwZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBkZXZpY2VUeXBlKCk7DQogICAgICAgICAgICBNZXRyaWMmIGRldmljZVR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljJiBkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljLmRldmljZVR5cGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5tZXRyaWNfTWV0cmljX1ZhbHVlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQoNCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiogX21ldHJpY19NZXRyaWNfVmFsdWVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgbWV0cmljX01ldHJpY19WYWx1ZXMoKTsNCiAgICAgICAgICAgIE1ldHJpYyYgbWV0cmljX01ldHJpY19WYWx1ZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdik7DQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpYy5tZXRyaWNfTWV0cmljX1ZhbHVlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWV0cmljJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTWV0cmljJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBNZXRyaWMmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIE1ldHJpYyYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxNZXRyaWM+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBEZXZpY2V7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIERldmljZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5EZXZpY2UoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgRGV2aWNlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgRGV2aWNlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIERldmljZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBEZXZpY2UmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgRGV2aWNlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgRGV2aWNlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBEZXZpY2UmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2UmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS50eXBlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIF90eXBlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIHR5cGUoKTsNCiAgICAgICAgICAgIERldmljZSYgdHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2UmIHR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UudHlwZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb250cm9sbGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogX2NvbnRyb2xsZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBjb250cm9sbGVyKCk7DQogICAgICAgICAgICBEZXZpY2UmIGNvbnRyb2xsZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2UmIGNvbnRyb2xsZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZS5jb250cm9sbGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZGV2aWNlX01ldHJpY19WYWx1ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OmFueT4qIF9kZXZpY2VfTWV0cmljX1ZhbHVlczsNCiAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGRldmljZV9NZXRyaWNfVmFsdWVzKCk7DQogICAgICAgICAgICBEZXZpY2UmIGRldmljZV9NZXRyaWNfVmFsdWVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpOw0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZGV2aWNlX01ldHJpY19WYWx1ZXMgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2UuZGV2aWNlX0RldmljZV9BdHRyaWJ1dGVzIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCg0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+KiBfZGV2aWNlX0RldmljZV9BdHRyaWJ1dGVzOw0KICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZGV2aWNlX0RldmljZV9BdHRyaWJ1dGVzKCk7DQogICAgICAgICAgICBEZXZpY2UmIGRldmljZV9EZXZpY2VfQXR0cmlidXRlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KTsNCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlLmRldmljZV9EZXZpY2VfQXR0cmlidXRlcyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgRGV2aWNlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgRGV2aWNlJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBEZXZpY2UmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIERldmljZSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxEZXZpY2U+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBEZXZpY2VfQXR0cmlidXRlew0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlKCl7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgfkRldmljZV9BdHRyaWJ1dGUoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9hY3RpdmU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgYm9vbCBhY3RpdmUoKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIGFjdGl2ZShib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmVuYWJsZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgYm9vbCBfZW5hYmxlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGVuYWJsZWQoKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIGVuYWJsZWQoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuY29kZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfY29kZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBjb2RlKCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBjb2RlKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBpbnQgX29yZGVyOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGludCBvcmRlcigpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgb3JkZXIoaW50IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuZGF0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB0aW1lX3QgX2RhdGU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgdGltZV90IGRhdGUoKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIGRhdGUodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5uYW1lIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9uYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIG5hbWUoKTsNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIG5hbWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfcmVtYXJrOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHJlbWFyaygpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgcmVtYXJrKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5yZW1hcmsgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLnZhbHVlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF92YWx1ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyB2YWx1ZSgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgdmFsdWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLnZhbHVlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5kZXZpY2UgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIF9kZXZpY2U7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIGRldmljZSgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgZGV2aWNlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogRGV2aWNlX0F0dHJpYnV0ZS5kZXZpY2UgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBEZXZpY2VfQXR0cmlidXRlLmF0dHJpYnV0ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlKiBfYXR0cmlidXRlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIGF0dHJpYnV0ZSgpOw0KICAgICAgICAgICAgRGV2aWNlX0F0dHJpYnV0ZSYgYXR0cmlidXRlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIGF0dHJpYnV0ZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIERldmljZV9BdHRyaWJ1dGUuYXR0cmlidXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIERldmljZV9BdHRyaWJ1dGUmIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBEZXZpY2VfQXR0cmlidXRlJiBfZnJvbURvY3VtZW50KGpzb24gb2JqKTsNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPERldmljZV9BdHRyaWJ1dGU+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIHN0b3JlKCk7DQogICAgDQogICAgICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZT4mIGZpbmRBbGwoKTsNCiAgICANCiAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCiAgICBjbGFzcyBNZXRyaWNfVmFsdWV7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSgpew0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIH5NZXRyaWNfVmFsdWUoKXsNCiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgIm5ldyIgdGhlcmUgbXVzdCBiZSBhICJkZWxldGUiDQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdW5zaWduZWQgbG9uZyBJZDsNCg0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBhY3RpdmUoYm9vbCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5hY3RpdmUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBlbmFibGVkKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgY29kZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIG9yZGVyKGludCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5vcmRlciBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBkYXRlKHRpbWVfdCB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBuYW1lKHN0ZDo6c3RyaW5nIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIHJlbWFyayhzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIHJlbWFyayhqc29uIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS52YWx1ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdmFsdWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgdmFsdWUoKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgdmFsdWUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUudmFsdWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBNZXRyaWNfVmFsdWUubWVhc3VyZWQgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgdGltZV90IF9tZWFzdXJlZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgbWVhc3VyZWQoKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgbWVhc3VyZWQodGltZV90IHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm1lYXN1cmVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm1ldHJpYyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyogX21ldHJpYzsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyogbWV0cmljKCk7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIG1ldHJpYyhlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgdik7DQogICAgICAgIA0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBtZXRyaWMoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMqIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogTWV0cmljX1ZhbHVlLm1ldHJpYyBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5kZXZpY2UgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIF9kZXZpY2U7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIGRldmljZSgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIHYpOw0KICAgICAgICANCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgZGV2aWNlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlKiB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIE1ldHJpY19WYWx1ZS5kZXZpY2UgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KDQogICAgDQoNCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBfdW5pcXVlKCk7DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBfdG9Eb2N1bWVudCgpOw0KICAgICAgICAgICAgTWV0cmljX1ZhbHVlJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBNZXRyaWNfVmFsdWUmIF9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKTsNCiAgICAgICAgICAgIE1ldHJpY19WYWx1ZSYgX2Zyb21Eb2N1bWVudChqc29uIG9iaik7DQogICAgICAgICAgICBzdGQ6OnZlY3RvcjxNZXRyaWNfVmFsdWU+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgc3RvcmUoKTsNCiAgICANCiAgICAgICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU+JiBmaW5kQWxsKCk7DQogICAgDQogICAgICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBmaW5kKCk7DQogICAgDQogICAgfTsNCiAgICANCn0KCQp9CgkKfQoJCn0KCQ0KDQpuYW1lc3BhY2UgZXNwdGVzdHsKCQ0KICAgIA0KICAgIGNsYXNzIFVzZXJ7DQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFVzZXIoKXsNCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICB+VXNlcigpew0KICAgICAgICAgICAgICAgIC8vIGZvciBldmVyeSAibmV3IiB0aGVyZSBtdXN0IGJlIGEgImRlbGV0ZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICB1bnNpZ25lZCBsb25nIElkOw0KDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIuYWN0aXZlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGJvb2wgX2FjdGl2ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBib29sIGFjdGl2ZSgpOw0KICAgICAgICAgICAgVXNlciYgYWN0aXZlKGJvb2wgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLmFjdGl2ZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIuZW5hYmxlZCBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgICAgIHByaXZhdGU6DQogICAgICAgICAgICBib29sIF9lbmFibGVkOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIGJvb2wgZW5hYmxlZCgpOw0KICAgICAgICAgICAgVXNlciYgZW5hYmxlZChib29sIHYpOw0KICAgICAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5lbmFibGVkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5jb2RlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9jb2RlOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIGNvZGUoKTsNCiAgICAgICAgICAgIFVzZXImIGNvZGUoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLmNvZGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIGludCBfb3JkZXI7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgaW50IG9yZGVyKCk7DQogICAgICAgICAgICBVc2VyJiBvcmRlcihpbnQgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLm9yZGVyIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCiAgICAgICAgLyoqKioqKioqKioqKiogVXNlci5kYXRlIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHRpbWVfdCBfZGF0ZTsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICB0aW1lX3QgZGF0ZSgpOw0KICAgICAgICAgICAgVXNlciYgZGF0ZSh0aW1lX3Qgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLmRhdGUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX25hbWU7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgbmFtZSgpOw0KICAgICAgICAgICAgVXNlciYgbmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIubmFtZSBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIucmVtYXJrIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9yZW1hcms7DQogICAgICAgICAgICANCiAgICAgICAgcHVibGljOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgcmVtYXJrKCk7DQogICAgICAgICAgICBVc2VyJiByZW1hcmsoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAgICAgVXNlciYgcmVtYXJrKGpzb24gdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLnJlbWFyayBHRVRURVJTIEFORCBTRVRURVJTICoqKioqKioqKioqKioqKioqKioqKiovDQogICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIudXNlcm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgICAgICBwcml2YXRlOg0KICAgICAgICAgICAgc3RkOjpzdHJpbmcgX3VzZXJuYW1lOw0KICAgICAgICAgICAgDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIHVzZXJuYW1lKCk7DQogICAgICAgICAgICBVc2VyJiB1c2VybmFtZShzdGQ6OnN0cmluZyB2KTsNCiAgICAgICAgDQogICAgICAgIC8qKioqKioqKioqKioqIFVzZXIudXNlcm5hbWUgR0VUVEVSUyBBTkQgU0VUVEVSUyAqKioqKioqKioqKioqKioqKioqKioqLw0KICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLnBhc3N3b3JkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICAgICAgcHJpdmF0ZToNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF9wYXNzd29yZDsNCiAgICAgICAgICAgIA0KICAgICAgICBwdWJsaWM6DQogICAgICAgICAgICBzdGQ6OnN0cmluZyBwYXNzd29yZCgpOw0KICAgICAgICAgICAgVXNlciYgcGFzc3dvcmQoc3RkOjpzdHJpbmcgdik7DQogICAgICAgIA0KICAgICAgICAvKioqKioqKioqKioqKiBVc2VyLnBhc3N3b3JkIEdFVFRFUlMgQU5EIFNFVFRFUlMgKioqKioqKioqKioqKioqKioqKioqKi8NCiAgICANCg0KICAgIA0KDQogICAgICAgIHB1YmxpYzoNCiAgICAgICAgICAgIFVzZXImIF91bmlxdWUoKTsNCiAgICAgICAgICAgIHN0ZDo6c3RyaW5nIF90b0RvY3VtZW50KCk7DQogICAgICAgICAgICBVc2VyJiBfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iaik7DQogICAgICAgICAgICBVc2VyJiBfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iaik7DQogICAgICAgICAgICBVc2VyJiBfZnJvbURvY3VtZW50KGpzb24gb2JqKTsNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPFVzZXI+JiYgX2Zyb21Eb2N1bWVudHMoanNvbiBvYmopOw0KICAgIA0KICAgICAgICBlc3B0ZXN0OjpVc2VyJiBzdG9yZSgpOw0KICAgIA0KICAgICAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0OjpVc2VyPiYgZmluZEFsbCgpOw0KICAgIA0KICAgICAgICBlc3B0ZXN0OjpVc2VyJiBmaW5kKCk7DQogICAgDQogICAgICAgIGpzb24gaW5pdCgpOw0KICAgIA0KICAgIH07DQogICAgDQp9CgkNCg0KLyoqKioqKioqKioqKiogSGVhZGVyIEZpbGUgRU5EICoqKioqKioqKioqKioqKioqKioqKiovDQoNCg0Kc3RhdGljIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdGhpc05vZGUgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSgpKS0+Y29kZSgiYWJjIikuYWN0aXZlKHRydWUpLmVuYWJsZWQodHJ1ZSk7DQoNCg0KICAgIA0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6VXNlcjo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OlVzZXI6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6VXNlcjo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6VXNlcjo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6VXNlcjo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0OjpVc2VyOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0OjpVc2VyOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6dXNlcm5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3VzZXJuYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OlVzZXI6OnVzZXJuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl91c2VybmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6cGFzc3dvcmQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3Bhc3N3b3JkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OlVzZXI6OnBhc3N3b3JkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXNzd29yZDsNCn0NCiAgICANCg0KICAgIA0KDQoNCmVzcHRlc3Q6OlVzZXImIGVzcHRlc3Q6OlVzZXI6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlVzZXI6Ol91bmlxdWUoKTogIjsNCg0KICAgIFVzZXIqIHJldCA9IG5ldyBVc2VyKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+dXNlcm5hbWUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT51c2VybmFtZSh0aGlzLT51c2VybmFtZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0OjpVc2VyPiYmIGVzcHRlc3Q6OlVzZXI6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0OjpVc2VyPiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6VXNlciY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0OjpVc2VyOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6VXNlciYgZXNwdGVzdDo6VXNlcjo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlVzZXI6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Vc2VyLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJVc2VyIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6VXNlciogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OlVzZXI+JiBlc3B0ZXN0OjpVc2VyOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJVc2VyOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Vc2VyLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiVXNlciIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OlVzZXI+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0OjpVc2VyJiBlc3B0ZXN0OjpVc2VyOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJVc2VyOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Vc2VyLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiVXNlciIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OlVzZXIqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpqc29uIGVzcHRlc3Q6OlVzZXI6OmluaXQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlVzZXI6OmluaXQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlVzZXIuaW5pdCgpIikubWV0aG9kKCJpbml0IikuY2xhc3NOYW1lKCJVc2VyIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAganNvbiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoKHN0ZDo6c3RyaW5nKWFuc3dlcik7DQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6c2NyaXB0KHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9zY3JpcHQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6c2NyaXB0KGpzb24gdil7DQogICAgLy90aGlzLT5fc2NyaXB0DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6c2NyaXB0KCl7DQogICAgcmV0dXJuIHRoaXMtPl9zY3JpcHQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiB2KXsNCiAgICB0aGlzLT5fdHlwZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3R5cGUgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjp0eXBlKCl7DQogICAgcmV0dXJuIHRoaXMtPl90eXBlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmRldmljZVR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgdil7DQogICAgdGhpcy0+X2RldmljZVR5cGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmRldmljZVR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9kZXZpY2VUeXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6ZGV2aWNlVHlwZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGV2aWNlVHlwZTsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Om1ldHJpY19NZXRyaWNfVmFsdWVzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fbWV0cmljX01ldHJpY19WYWx1ZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjptZXRyaWNfTWV0cmljX1ZhbHVlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWM6Ol91bmlxdWUoKTogIjsNCg0KICAgIE1ldHJpYyogcmV0ID0gbmV3IE1ldHJpYygpOw0KICAgIGlmKHRoaXMtPklkIT0wKSByZXQtPklkID0gdGhpcy0+SWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYzo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpfZnJvbURvY3VtZW50cyhqc29uIG9iail7DQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJNZXRyaWMiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpYzo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiTWV0cmljIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWM6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpYzo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiTWV0cmljIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjp2YWx1ZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fdmFsdWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OnZhbHVlKCl7DQogICAgcmV0dXJuIHRoaXMtPl92YWx1ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjptZWFzdXJlZCh0aW1lX3Qgdil7DQogICAgdGhpcy0+X21lYXN1cmVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6bWVhc3VyZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X21lYXN1cmVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Om1ldHJpYyhlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpYyYgdil7DQogICAgdGhpcy0+X21ldHJpYyA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6bWV0cmljKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X21ldHJpYyA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWMqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjptZXRyaWMoKXsNCiAgICByZXR1cm4gdGhpcy0+X21ldHJpYzsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpkZXZpY2UoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIHYpew0KICAgIHRoaXMtPl9kZXZpY2UgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OmRldmljZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9kZXZpY2UgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZGV2aWNlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kZXZpY2U7DQp9DQogICAgDQoNCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19WYWx1ZTo6X3VuaXF1ZSgpOiAiOw0KDQogICAgTWV0cmljX1ZhbHVlKiByZXQgPSBuZXcgTWV0cmljX1ZhbHVlKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+bWV0cmljKCkhPW51bGxwdHIpDQogICAgICAgIA0KICAgICAgICByZXQtPm1ldHJpYyh0aGlzLT5tZXRyaWMoKS0+X3VuaXF1ZSgpKTsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+ZGV2aWNlKCkhPW51bGxwdHIpDQogICAgICAgIA0KICAgICAgICByZXQtPmRldmljZSh0aGlzLT5kZXZpY2UoKS0+X3VuaXF1ZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBpZiAoc3RkOjpyZWdleF9tYXRjaChvYmosIHN0ZDo6cmVnZXgoUiIiKCgoW0EtWmEtel17Myw5fTooPzovLyk/KSg/OlstOzomPSskLHddK0ApP1tBLVphLXowLTkuLV0rfCg/Ond3dy58Wy07OiY9KyQsd10rQClbQS1aYS16MC05Li1dKykoKD86L1srfiUvLnctX10qKT8/Pyg/OlstKz0mOyVALndfXSopIz8oPzpbd10qKSk/KSIiKSkpew0KICAgICAgICBzdGQ6OnN0cmluZyByZWFkQnVmZmVyOw0KICAgICAgICBDVVJMICpjdXJsID0gY3VybF9lYXN5X2luaXQoKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1VSTCwgb2JqKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCAxTCk7DQogICAgICAgIC8vY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFRlVOQ1RJT04sICtbXSh2b2lkICpwdHIsIHNpemVfdCBzaXplLCBzaXplX3Qgbm1lbWIsIHZvaWQgKnN0cmVhbSkgLT4gc2l6ZV90IHsgcmVhZEJ1ZmZlci5hcHBlbmQoKnB0ciwgc2l6ZSAqIG5tZW1iKTsgfSk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURURBVEEsICZyZWFkQnVmZmVyKTsNCiAgICAgICAgY3VybF9lYXN5X3BlcmZvcm0oY3VybCk7DQogICAgICAgIGN1cmxfZWFzeV9jbGVhbnVwKGN1cmwpOw0KICAgICAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChyZWFkQnVmZmVyKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChqc29uOjpwYXJzZShvYmopKTsNCn0NCg0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZT4gcmV0ID0gbmV3IHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJj4ob2JqLnNpemUoKSk7DQogICAgDQogICAgcmV0dXJuIG1vdmUoKipyZXQpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Ol9mcm9tRG9jdW1lbnQoanNvbiBvYmopew0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWNfVmFsdWU6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVmFsdWUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk1ldHJpY19WYWx1ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVmFsdWU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1ZhbHVlOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVmFsdWUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJNZXRyaWNfVmFsdWUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1ZhbHVlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1ZhbHVlOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVmFsdWUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJNZXRyaWNfVmFsdWUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19WYWx1ZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgdil7DQogICAgdGhpcy0+X3R5cGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90eXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6dHlwZSgpew0KICAgIHJldHVybiB0aGlzLT5fdHlwZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpjb250cm9sbGVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X2NvbnRyb2xsZXIgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmNvbnRyb2xsZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2NvbnRyb2xsZXIgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmNvbnRyb2xsZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvbnRyb2xsZXI7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpkZXZpY2VfTWV0cmljX1ZhbHVlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2RldmljZV9NZXRyaWNfVmFsdWVzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6ZGV2aWNlX01ldHJpY19WYWx1ZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmRldmljZV9EZXZpY2VfQXR0cmlidXRlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2RldmljZV9EZXZpY2VfQXR0cmlidXRlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmRldmljZV9EZXZpY2VfQXR0cmlidXRlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2U6Ol91bmlxdWUoKTogIjsNCg0KICAgIERldmljZSogcmV0ID0gbmV3IERldmljZSgpOw0KICAgIGlmKHRoaXMtPklkIT0wKSByZXQtPklkID0gdGhpcy0+SWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZTo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpfZnJvbURvY3VtZW50cyhqc29uIG9iail7DQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJEZXZpY2UiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZTo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiRGV2aWNlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2U6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZTo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiRGV2aWNlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2UqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6dmFsdWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3ZhbHVlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6dmFsdWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X3ZhbHVlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6ZGV2aWNlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlJiB2KXsNCiAgICB0aGlzLT5fZGV2aWNlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmRldmljZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9kZXZpY2UgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmRldmljZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGV2aWNlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6YXR0cmlidXRlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIHYpew0KICAgIHRoaXMtPl9hdHRyaWJ1dGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6YXR0cmlidXRlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fYXR0cmlidXRlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmF0dHJpYnV0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYXR0cmlidXRlOw0KfQ0KICAgIA0KDQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9BdHRyaWJ1dGU6Ol91bmlxdWUoKTogIjsNCg0KICAgIERldmljZV9BdHRyaWJ1dGUqIHJldCA9IG5ldyBEZXZpY2VfQXR0cmlidXRlKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+ZGV2aWNlKCkhPW51bGxwdHIpDQogICAgICAgIA0KICAgICAgICByZXQtPmRldmljZSh0aGlzLT5kZXZpY2UoKS0+X3VuaXF1ZSgpKTsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+YXR0cmlidXRlKCkhPW51bGxwdHIpDQogICAgICAgIA0KICAgICAgICByZXQtPmF0dHJpYnV0ZSh0aGlzLT5hdHRyaWJ1dGUoKS0+X3VuaXF1ZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX0F0dHJpYnV0ZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkRldmljZV9BdHRyaWJ1dGUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkRldmljZV9BdHRyaWJ1dGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9BdHRyaWJ1dGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkRldmljZV9BdHRyaWJ1dGUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJEZXZpY2VfQXR0cmlidXRlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9BdHRyaWJ1dGU6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9BdHRyaWJ1dGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkRldmljZV9BdHRyaWJ1dGUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJEZXZpY2VfQXR0cmlidXRlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQXR0cmlidXRlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpkZXZpY2VUeXBlKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIHYpew0KICAgIHRoaXMtPl9kZXZpY2VUeXBlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6ZGV2aWNlVHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2RldmljZVR5cGUgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmRldmljZVR5cGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RldmljZVR5cGU7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6OmF0dHJpYnV0ZV9EZXZpY2VfQXR0cmlidXRlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2F0dHJpYnV0ZV9EZXZpY2VfQXR0cmlidXRlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjphdHRyaWJ1dGVfRGV2aWNlX0F0dHJpYnV0ZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlR5cGVfQXR0cmlidXRlOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBUeXBlX0F0dHJpYnV0ZSogcmV0ID0gbmV3IFR5cGVfQXR0cmlidXRlKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+ZGV2aWNlVHlwZSgpIT1udWxscHRyKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5kZXZpY2VUeXBlKHRoaXMtPmRldmljZVR5cGUoKS0+X3VuaXF1ZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlPiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlR5cGVfQXR0cmlidXRlOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVHlwZV9BdHRyaWJ1dGUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIlR5cGVfQXR0cmlidXRlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpUeXBlX0F0dHJpYnV0ZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUeXBlX0F0dHJpYnV0ZTo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVHlwZV9BdHRyaWJ1dGUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJUeXBlX0F0dHJpYnV0ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGU+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OlR5cGVfQXR0cmlidXRlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUeXBlX0F0dHJpYnV0ZTo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVHlwZV9BdHRyaWJ1dGUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJUeXBlX0F0dHJpYnV0ZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6VHlwZV9BdHRyaWJ1dGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIHYpew0KICAgIHRoaXMtPl9wYXJlbnQgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OnBhcmVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9wYXJlbnQgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5KiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6cGFyZW50KCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXJlbnQ7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpwYXJlbnRfRGV2aWNlX0NhdGVnb3J5cygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3BhcmVudF9EZXZpY2VfQ2F0ZWdvcnlzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6cGFyZW50X0RldmljZV9DYXRlZ29yeXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNhdGVnb3J5X0RldmljZV9UeXBlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2NhdGVnb3J5X0RldmljZV9UeXBlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmNhdGVnb3J5X0RldmljZV9UeXBlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfQ2F0ZWdvcnk6Ol91bmlxdWUoKTogIjsNCg0KICAgIERldmljZV9DYXRlZ29yeSogcmV0ID0gbmV3IERldmljZV9DYXRlZ29yeSgpOw0KICAgIGlmKHRoaXMtPklkIT0wKSByZXQtPklkID0gdGhpcy0+SWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeTo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpfZnJvbURvY3VtZW50cyhqc29uIG9iail7DQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5OjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRGV2aWNlX0NhdGVnb3J5OjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlX0NhdGVnb3J5LnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJEZXZpY2VfQ2F0ZWdvcnkiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5PiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9DYXRlZ29yeTo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlX0NhdGVnb3J5LmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiRGV2aWNlX0NhdGVnb3J5IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnk6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9DYXRlZ29yeTo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlX0NhdGVnb3J5LmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiRGV2aWNlX0NhdGVnb3J5IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmNhdGVnb3J5KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX0NhdGVnb3J5JiB2KXsNCiAgICB0aGlzLT5fY2F0ZWdvcnkgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpjYXRlZ29yeShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9DYXRlZ29yeSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9jYXRlZ29yeSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfQ2F0ZWdvcnkqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmNhdGVnb3J5KCl7DQogICAgcmV0dXJuIHRoaXMtPl9jYXRlZ29yeTsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZGV2aWNlVHlwZV9NZXRyaWNzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fZGV2aWNlVHlwZV9NZXRyaWNzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmRldmljZVR5cGVfTWV0cmljcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjp0eXBlX0RldmljZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl90eXBlX0RldmljZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6dHlwZV9EZXZpY2VzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6OmRldmljZVR5cGVfVHlwZV9BdHRyaWJ1dGVzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fZGV2aWNlVHlwZV9UeXBlX0F0dHJpYnV0ZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6ZGV2aWNlVHlwZV9UeXBlX0F0dHJpYnV0ZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9UeXBlOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBEZXZpY2VfVHlwZSogcmV0ID0gbmV3IERldmljZV9UeXBlKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlPiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkRldmljZV9UeXBlOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlX1R5cGUuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkRldmljZV9UeXBlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpEZXZpY2VfVHlwZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfVHlwZTo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlX1R5cGUuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJEZXZpY2VfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGU+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6OkRldmljZV9UeXBlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJEZXZpY2VfVHlwZTo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRGV2aWNlX1R5cGUuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJEZXZpY2VfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6RGV2aWNlX1R5cGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Omdyb3VwX01ldHJpY19UeXBlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2dyb3VwX01ldHJpY19UeXBlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Omdyb3VwX01ldHJpY19UeXBlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpfdW5pcXVlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNZXRyaWNfR3JvdXA6Ol91bmlxdWUoKTogIjsNCg0KICAgIE1ldHJpY19Hcm91cCogcmV0ID0gbmV3IE1ldHJpY19Hcm91cCgpOw0KICAgIGlmKHRoaXMtPklkIT0wKSByZXQtPklkID0gdGhpcy0+SWQ7DQogICAgDQogICAgICAgIA0KICAgIGlmKHRoaXMtPmNvZGUoKS5lbXB0eSgpKQ0KICAgICAgICANCiAgICAgICAgcmV0LT5jb2RlKHRoaXMtPmNvZGUoKSk7DQogICAgDQoNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpfZnJvbURvY3VtZW50cyhqc29uIG9iail7DQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX0dyb3VwOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljX0dyb3VwLnN0b3JlKCkiKS5tZXRob2QoInN0b3JlIikuY2xhc3NOYW1lKCJNZXRyaWNfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwPiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19Hcm91cDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljX0dyb3VwLmZpbmRBbGwoKSIpLm1ldGhvZCgiZmluZEFsbCIpLmNsYXNzTmFtZSgiTWV0cmljX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXA6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19Hcm91cDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWV0cmljX0dyb3VwLmZpbmQoKSIpLm1ldGhvZCgiZmluZCIpLmNsYXNzTmFtZSgiTWV0cmljX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Omdyb3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX0dyb3VwJiB2KXsNCiAgICB0aGlzLT5fZ3JvdXAgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19Hcm91cCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9ncm91cCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfR3JvdXAqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Omdyb3VwKCl7DQogICAgcmV0dXJuIHRoaXMtPl9ncm91cDsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6dHlwZV9NZXRyaWNzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fdHlwZV9NZXRyaWNzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OnR5cGVfTWV0cmljcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1R5cGU6Ol91bmlxdWUoKTogIjsNCg0KICAgIE1ldHJpY19UeXBlKiByZXQgPSBuZXcgTWV0cmljX1R5cGUoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZTo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJj4ob2JqLnNpemUoKSk7DQogICAgDQogICAgcmV0dXJuIG1vdmUoKipyZXQpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWV0cmljX1R5cGU6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVHlwZS5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTWV0cmljX1R5cGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRpb3Q6Ok1ldHJpY19UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZT4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19UeXBlOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVHlwZS5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk1ldHJpY19UeXBlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZT4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGlvdDo6TWV0cmljX1R5cGU6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1ldHJpY19UeXBlOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5NZXRyaWNfVHlwZS5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk1ldHJpY19UeXBlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkaW90OjpNZXRyaWNfVHlwZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnZhbHVlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl92YWx1ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjp2YWx1ZShqc29uIHYpew0KICAgIC8vdGhpcy0+X3ZhbHVlDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dmFsdWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X3ZhbHVlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnNjcmlwdChzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fc2NyaXB0ID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnNjcmlwdChqc29uIHYpew0KICAgIC8vdGhpcy0+X3NjcmlwdA0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnNjcmlwdCgpew0KICAgIHJldHVybiB0aGlzLT5fc2NyaXB0Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnRvb2woZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiB2KXsNCiAgICB0aGlzLT5fdG9vbCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fdG9vbCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dG9vbCgpew0KICAgIHJldHVybiB0aGlzLT5fdG9vbDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgdil7DQogICAgdGhpcy0+X2dyb3VwID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9ncm91cCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpncm91cCgpew0KICAgIHJldHVybiB0aGlzLT5fZ3JvdXA7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgdil7DQogICAgdGhpcy0+X3R5cGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fdHlwZSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjp0eXBlKCl7DQogICAgcmV0dXJuIHRoaXMtPl90eXBlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Om5vZGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiB2KXsNCiAgICB0aGlzLT5fbm9kZSA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6bm9kZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fbm9kZSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6bm9kZSgpew0KICAgIHJldHVybiB0aGlzLT5fbm9kZTsNCn0NCiAgICANCg0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiQ29uZmlnOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBDb25maWcqIHJldCA9IG5ldyBDb25maWcoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWc6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZz4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnPiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZzo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkNvbmZpZzo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkNvbmZpZy5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiQ29uZmlnIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZz4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWc6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkNvbmZpZy5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIkNvbmZpZyIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWc6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkNvbmZpZy5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIkNvbmZpZyIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIHYpew0KICAgIHRoaXMtPl90eXBlID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnR5cGUoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fdHlwZSA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6dHlwZSgpew0KICAgIHJldHVybiB0aGlzLT5fdHlwZTsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjp0b29sX0NvbmZpZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl90b29sX0NvbmZpZ3MpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnRvb2xfQ29uZmlncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnRvb2xfTWFwcGluZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl90b29sX01hcHBpbmdzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjp0b29sX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVG9vbDo6X3VuaXF1ZSgpOiAiOw0KDQogICAgVG9vbCogcmV0ID0gbmV3IFRvb2woKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBpZiAoc3RkOjpyZWdleF9tYXRjaChvYmosIHN0ZDo6cmVnZXgoUiIiKCgoW0EtWmEtel17Myw5fTooPzovLyk/KSg/OlstOzomPSskLHddK0ApP1tBLVphLXowLTkuLV0rfCg/Ond3dy58Wy07OiY9KyQsd10rQClbQS1aYS16MC05Li1dKykoKD86L1srfiUvLnctX10qKT8/Pyg/OlstKz0mOyVALndfXSopIz8oPzpbd10qKSk/KSIiKSkpew0KICAgICAgICBzdGQ6OnN0cmluZyByZWFkQnVmZmVyOw0KICAgICAgICBDVVJMICpjdXJsID0gY3VybF9lYXN5X2luaXQoKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1VSTCwgb2JqKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCAxTCk7DQogICAgICAgIC8vY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFRlVOQ1RJT04sICtbXSh2b2lkICpwdHIsIHNpemVfdCBzaXplLCBzaXplX3Qgbm1lbWIsIHZvaWQgKnN0cmVhbSkgLT4gc2l6ZV90IHsgcmVhZEJ1ZmZlci5hcHBlbmQoKnB0ciwgc2l6ZSAqIG5tZW1iKTsgfSk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURURBVEEsICZyZWFkQnVmZmVyKTsNCiAgICAgICAgY3VybF9lYXN5X3BlcmZvcm0oY3VybCk7DQogICAgICAgIGN1cmxfZWFzeV9jbGVhbnVwKGN1cmwpOw0KICAgICAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChyZWFkQnVmZmVyKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChqc29uOjpwYXJzZShvYmopKTsNCn0NCg0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbD4gcmV0ID0gbmV3IHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6Ol9mcm9tRG9jdW1lbnQoanNvbiBvYmopew0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUb29sOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVG9vbC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiVG9vbCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVG9vbDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVG9vbC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIlRvb2wiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2w+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbDo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVG9vbDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uVG9vbC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIlRvb2wiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Omdyb3VwX0NvbmZpZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9ncm91cF9Db25maWdzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6Z3JvdXBfQ29uZmlncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6Z3JvdXBfTWFwcGluZ3MoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9ncm91cF9NYXBwaW5ncykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Omdyb3VwX01hcHBpbmdzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkNvbmZpZ19Hcm91cDo6X3VuaXF1ZSgpOiAiOw0KDQogICAgQ29uZmlnX0dyb3VwKiByZXQgPSBuZXcgQ29uZmlnX0dyb3VwKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwOjpfZnJvbURvY3VtZW50KHVuc2lnbmVkIGNoYXIqIG9iail7DQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcoIG9iaiwgb2JqICsgc2l6ZW9mIG9iaiAvIHNpemVvZiBvYmpbMF0gKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBpZiAoc3RkOjpyZWdleF9tYXRjaChvYmosIHN0ZDo6cmVnZXgoUiIiKCgoW0EtWmEtel17Myw5fTooPzovLyk/KSg/OlstOzomPSskLHddK0ApP1tBLVphLXowLTkuLV0rfCg/Ond3dy58Wy07OiY9KyQsd10rQClbQS1aYS16MC05Li1dKykoKD86L1srfiUvLnctX10qKT8/Pyg/OlstKz0mOyVALndfXSopIz8oPzpbd10qKSk/KSIiKSkpew0KICAgICAgICBzdGQ6OnN0cmluZyByZWFkQnVmZmVyOw0KICAgICAgICBDVVJMICpjdXJsID0gY3VybF9lYXN5X2luaXQoKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1VSTCwgb2JqKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCAxTCk7DQogICAgICAgIC8vY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFRlVOQ1RJT04sICtbXSh2b2lkICpwdHIsIHNpemVfdCBzaXplLCBzaXplX3Qgbm1lbWIsIHZvaWQgKnN0cmVhbSkgLT4gc2l6ZV90IHsgcmVhZEJ1ZmZlci5hcHBlbmQoKnB0ciwgc2l6ZSAqIG5tZW1iKTsgfSk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURURBVEEsICZyZWFkQnVmZmVyKTsNCiAgICAgICAgY3VybF9lYXN5X3BlcmZvcm0oY3VybCk7DQogICAgICAgIGN1cmxfZWFzeV9jbGVhbnVwKGN1cmwpOw0KICAgICAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChyZWFkQnVmZmVyKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChqc29uOjpwYXJzZShvYmopKTsNCn0NCg0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cD4gcmV0ID0gbmV3IHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJj4ob2JqLnNpemUoKSk7DQogICAgDQogICAgcmV0dXJuIG1vdmUoKipyZXQpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Ol9mcm9tRG9jdW1lbnQoanNvbiBvYmopew0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6Ol90b0RvY3VtZW50KCl7DQogICAgcmV0dXJuICIiOw0KfQ0KDQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJDb25maWdfR3JvdXA6OnN0b3JlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Db25maWdfR3JvdXAuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkNvbmZpZ19Hcm91cCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXA+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiQ29uZmlnX0dyb3VwOjpmaW5kQWxsKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Db25maWdfR3JvdXAuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJDb25maWdfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cD4qIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyLT5lbXB0eSgpKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Q29uZmlnX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cDo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiQ29uZmlnX0dyb3VwOjpmaW5kKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Db25maWdfR3JvdXAuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJDb25maWdfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCg0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6YWN0aXZlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hY3RpdmU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OmVuYWJsZWQoKXsNCiAgICByZXR1cm4gdGhpcy0+X2VuYWJsZWQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6Y29kZSgpew0KICAgIHJldHVybiB0aGlzLT5fY29kZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6ZGF0ZSgpew0KICAgIHJldHVybiB0aGlzLT5fZGF0ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpuYW1lKCl7DQogICAgcmV0dXJuIHRoaXMtPl9uYW1lOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWFwcGluZ19Hcm91cDo6X3VuaXF1ZSgpOiAiOw0KDQogICAgTWFwcGluZ19Hcm91cCogcmV0ID0gbmV3IE1hcHBpbmdfR3JvdXAoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBpZiAoc3RkOjpyZWdleF9tYXRjaChvYmosIHN0ZDo6cmVnZXgoUiIiKCgoW0EtWmEtel17Myw5fTooPzovLyk/KSg/OlstOzomPSskLHddK0ApP1tBLVphLXowLTkuLV0rfCg/Ond3dy58Wy07OiY9KyQsd10rQClbQS1aYS16MC05Li1dKykoKD86L1srfiUvLnctX10qKT8/Pyg/OlstKz0mOyVALndfXSopIz8oPzpbd10qKSk/KSIiKSkpew0KICAgICAgICBzdGQ6OnN0cmluZyByZWFkQnVmZmVyOw0KICAgICAgICBDVVJMICpjdXJsID0gY3VybF9lYXN5X2luaXQoKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1VSTCwgb2JqKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCAxTCk7DQogICAgICAgIC8vY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFRlVOQ1RJT04sICtbXSh2b2lkICpwdHIsIHNpemVfdCBzaXplLCBzaXplX3Qgbm1lbWIsIHZvaWQgKnN0cmVhbSkgLT4gc2l6ZV90IHsgcmVhZEJ1ZmZlci5hcHBlbmQoKnB0ciwgc2l6ZSAqIG5tZW1iKTsgfSk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURURBVEEsICZyZWFkQnVmZmVyKTsNCiAgICAgICAgY3VybF9lYXN5X3BlcmZvcm0oY3VybCk7DQogICAgICAgIGN1cmxfZWFzeV9jbGVhbnVwKGN1cmwpOw0KICAgICAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChyZWFkQnVmZmVyKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChqc29uOjpwYXJzZShvYmopKTsNCn0NCg0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cD4gcmV0ID0gbmV3IHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6Ol9mcm9tRG9jdW1lbnQoanNvbiBvYmopew0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJNYXBwaW5nX0dyb3VwOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWFwcGluZ19Hcm91cC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTWFwcGluZ19Hcm91cCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWFwcGluZ19Hcm91cDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWFwcGluZ19Hcm91cC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk1hcHBpbmdfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXA+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZ19Hcm91cDo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWFwcGluZ19Hcm91cDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTWFwcGluZ19Hcm91cC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk1hcHBpbmdfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmdfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQoNCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OmFjdGl2ZSgpew0KICAgIHJldHVybiB0aGlzLT5fYWN0aXZlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjplbmFibGVkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9lbmFibGVkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OmNvZGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NvZGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Om9yZGVyKCl7DQogICAgcmV0dXJuIHRoaXMtPl9vcmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OmRhdGUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2RhdGU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6bmFtZSgpew0KICAgIHJldHVybiB0aGlzLT5fbmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OnR5cGVfQ29uZmlncygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3R5cGVfQ29uZmlncykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OnR5cGVfQ29uZmlncyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6dHlwZV9Ub29scygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3R5cGVfVG9vbHMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjp0eXBlX1Rvb2xzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjp0eXBlX01hcHBpbmdzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fdHlwZV9NYXBwaW5ncykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6OnR5cGVfTWFwcGluZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiVG9vbF9UeXBlOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBUb29sX1R5cGUqIHJldCA9IG5ldyBUb29sX1R5cGUoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlPiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIlRvb2xfVHlwZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlRvb2xfVHlwZS5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiVG9vbF9UeXBlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZT4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUb29sX1R5cGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlRvb2xfVHlwZS5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIlRvb2xfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJUb29sX1R5cGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLlRvb2xfVHlwZS5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIlRvb2xfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbF9UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmFjdGl2ZShib29sIHYpew0KICAgIHRoaXMtPl9hY3RpdmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6ZW5hYmxlZChib29sIHYpew0KICAgIHRoaXMtPl9lbmFibGVkID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6Y29kZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fY29kZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50Ojpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpvcmRlcihpbnQgdil7DQogICAgdGhpcy0+X29yZGVyID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmludCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmRhdGUodGltZV90IHYpew0KICAgIHRoaXMtPl9kYXRlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnRpbWVfdCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpuYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9uYW1lID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlbWFyayhzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fcmVtYXJrID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpyZW1hcmsoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9yZW1hcmsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlbWFyaygpew0KICAgIHJldHVybiB0aGlzLT5fcmVtYXJrOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjbGFzc05hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NsYXNzTmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjbGFzc05hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NsYXNzTmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6bWV0aG9kKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9tZXRob2QgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6bWV0aG9kKCl7DQogICAgcmV0dXJuIHRoaXMtPl9tZXRob2Q7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnBheWxvYWQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3BheWxvYWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnBheWxvYWQoanNvbiB2KXsNCiAgICAvL3RoaXMtPl9wYXlsb2FkDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpwYXlsb2FkKCl7DQogICAgcmV0dXJuIHRoaXMtPl9wYXlsb2FkOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjYXJyaWVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X2NhcnJpZXIgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpjYXJyaWVyKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9jYXJyaWVyID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OmNhcnJpZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NhcnJpZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnNlbmRlcihlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIHYpew0KICAgIHRoaXMtPl9zZW5kZXIgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpzZW5kZXIoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3NlbmRlciA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpzZW5kZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X3NlbmRlcjsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cmVjaXBpZW50KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X3JlY2lwaWVudCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlY2lwaWVudChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIHYpew0KICAgIGlmKHYhPW51bGxwdHIpew0KICAgICAgICB0aGlzLT5fcmVjaXBpZW50ID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlY2lwaWVudCgpew0KICAgIHJldHVybiB0aGlzLT5fcmVjaXBpZW50Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpyZXNwb25zZVRvKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIHYpew0KICAgIHRoaXMtPl9yZXNwb25zZVRvID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cmVzcG9uc2VUbyhlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3Jlc3BvbnNlVG8gPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlc3BvbnNlVG8oKXsNCiAgICByZXR1cm4gdGhpcy0+X3Jlc3BvbnNlVG87DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnJlc3BvbnNlVG9fRXZlbnRzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fcmVzcG9uc2VUb19FdmVudHMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cmVzcG9uc2VUb19FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkV2ZW50OjpfdW5pcXVlKCk6ICI7DQoNCiAgICBFdmVudCogcmV0ID0gbmV3IEV2ZW50KCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+Y29kZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPmNvZGUodGhpcy0+Y29kZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50PiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkV2ZW50OjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRXZlbnQuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIkV2ZW50IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJFdmVudDo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRXZlbnQuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJFdmVudCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50OjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJFdmVudDo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRXZlbnQuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJFdmVudCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpqc29uIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6Omxpc3Rlbihlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIG5vZGUpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRXZlbnQ6Omxpc3RlbigpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uRXZlbnQubGlzdGVuKCkiKS5tZXRob2QoImxpc3RlbiIpLmNsYXNzTmFtZSgiRXZlbnQiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBqc29uIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCgoc3RkOjpzdHJpbmcpYW5zd2VyKTsNCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiBhbnN3ZXI7DQp9DQogICAgDQpqc29uIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQ6OnRyaWdnZXIoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIkV2ZW50Ojp0cmlnZ2VyKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5FdmVudC50cmlnZ2VyKCkiKS5tZXRob2QoInRyaWdnZXIiKS5jbGFzc05hbWUoIkV2ZW50IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAganNvbiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoKHN0ZDo6c3RyaW5nKWFuc3dlcik7DQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudDo6cHJvY2Vzcygpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiRXZlbnQ6OnByb2Nlc3MoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLkV2ZW50LnByb2Nlc3MoKSIpLm1ldGhvZCgicHJvY2VzcyIpLmNsYXNzTmFtZSgiRXZlbnQiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmFkZHJlc3Moc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2FkZHJlc3MgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjphZGRyZXNzKCl7DQogICAgcmV0dXJuIHRoaXMtPl9hZGRyZXNzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6YmFja3VwKGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X2JhY2t1cCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpiYWNrdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2JhY2t1cCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmJhY2t1cCgpew0KICAgIHJldHVybiB0aGlzLT5fYmFja3VwOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cGFyZW50KGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgdil7DQogICAgdGhpcy0+X3BhcmVudCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpwYXJlbnQoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3BhcmVudCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnBhcmVudCgpew0KICAgIHJldHVybiB0aGlzLT5fcGFyZW50Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Z3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiB2KXsNCiAgICB0aGlzLT5fZ3JvdXAgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Z3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X2dyb3VwID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Z3JvdXAoKXsNCiAgICByZXR1cm4gdGhpcy0+X2dyb3VwOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Y29udGV4dChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgdil7DQogICAgdGhpcy0+X2NvbnRleHQgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Y29udGV4dChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9jb250ZXh0ID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjb250ZXh0KCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb250ZXh0Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cG9ydChpbnQgdil7DQogICAgdGhpcy0+X3BvcnQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cG9ydCgpew0KICAgIHJldHVybiB0aGlzLT5fcG9ydDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Om9ubGluZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X29ubGluZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpvbmxpbmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X29ubGluZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnNlY3VyZShib29sIHYpew0KICAgIHRoaXMtPl9zZWN1cmUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnNlY3VyZSgpew0KICAgIHJldHVybiB0aGlzLT5fc2VjdXJlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgdil7DQogICAgdGhpcy0+X3R5cGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90eXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjp0eXBlKCl7DQogICAgcmV0dXJuIHRoaXMtPl90eXBlOw0KfQ0KICAgIA0KDQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmNvbnRyb2xsZXJfRGV2aWNlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2NvbnRyb2xsZXJfRGV2aWNlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6Y29udHJvbGxlcl9EZXZpY2VzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6bm9kZV9Db25maWdzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fbm9kZV9Db25maWdzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpub2RlX0NvbmZpZ3Moc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjYXJyaWVyX0V2ZW50cygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2NhcnJpZXJfRXZlbnRzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpjYXJyaWVyX0V2ZW50cyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnNlbmRlcl9FdmVudHMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9zZW5kZXJfRXZlbnRzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpzZW5kZXJfRXZlbnRzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cmVjaXBpZW50X0V2ZW50cygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3JlY2lwaWVudF9FdmVudHMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnJlY2lwaWVudF9FdmVudHMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpiYWNrdXBfTm9kZXMoKXsNCiAgICByZXR1cm4gbW92ZSgqKHRoaXMtPl9iYWNrdXBfTm9kZXMpKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmJhY2t1cF9Ob2RlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQpzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnBhcmVudF9Ob2Rlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X3BhcmVudF9Ob2RlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6cGFyZW50X05vZGVzKHN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIHYpew0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZTo6X3VuaXF1ZSgpOiAiOw0KDQogICAgTm9kZSogcmV0ID0gbmV3IE5vZGUoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6X2Zyb21Eb2N1bWVudCh1bnNpZ25lZCBjaGFyKiBvYmopew0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nKCBvYmosIG9iaiArIHNpemVvZiBvYmogLyBzaXplb2Ygb2JqWzBdICkpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyBvYmopew0KICAgIGlmKG9iai5lbXB0eSgpKSByZXR1cm4gKnRoaXM7DQoNCiAgICBpZiAoc3RkOjpyZWdleF9tYXRjaChvYmosIHN0ZDo6cmVnZXgoUiIiKCgoW0EtWmEtel17Myw5fTooPzovLyk/KSg/OlstOzomPSskLHddK0ApP1tBLVphLXowLTkuLV0rfCg/Ond3dy58Wy07OiY9KyQsd10rQClbQS1aYS16MC05Li1dKykoKD86L1srfiUvLnctX10qKT8/Pyg/OlstKz0mOyVALndfXSopIz8oPzpbd10qKSk/KSIiKSkpew0KICAgICAgICBzdGQ6OnN0cmluZyByZWFkQnVmZmVyOw0KICAgICAgICBDVVJMICpjdXJsID0gY3VybF9lYXN5X2luaXQoKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1VSTCwgb2JqKTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCAxTCk7DQogICAgICAgIC8vY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFRlVOQ1RJT04sICtbXSh2b2lkICpwdHIsIHNpemVfdCBzaXplLCBzaXplX3Qgbm1lbWIsIHZvaWQgKnN0cmVhbSkgLT4gc2l6ZV90IHsgcmVhZEJ1ZmZlci5hcHBlbmQoKnB0ciwgc2l6ZSAqIG5tZW1iKTsgfSk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURURBVEEsICZyZWFkQnVmZmVyKTsNCiAgICAgICAgY3VybF9lYXN5X3BlcmZvcm0oY3VybCk7DQogICAgICAgIGN1cmxfZWFzeV9jbGVhbnVwKGN1cmwpOw0KICAgICAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChyZWFkQnVmZmVyKTsNCiAgICB9DQoNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChqc29uOjpwYXJzZShvYmopKTsNCn0NCg0Kc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlPiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZT4gcmV0ID0gbmV3IHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSY+KG9iai5zaXplKCkpOw0KICAgIA0KICAgIHJldHVybiBtb3ZlKCoqcmV0KTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6Ol9mcm9tRG9jdW1lbnQoanNvbiBvYmopew0KICAgIHJldHVybiAqdGhpczsNCn0NCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlOjpfdG9Eb2N1bWVudCgpew0KICAgIHJldHVybiAiIjsNCn0NCg0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OnN0b3JlKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlOjpzdG9yZSgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZS5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTm9kZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZSogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXIhPW51bGxwdHIpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoYW5zd2VyLT5fdG9Eb2N1bWVudCgpKTsNCiAgICAgICAgDQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gKmFuc3dlcjsNCn0NCiAgICANCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZT4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6ZmluZEFsbCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZTo6ZmluZEFsbCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZS5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk5vZGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU+KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlci0+ZW1wdHkoKSl7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6ZmluZCgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZTo6ZmluZCgpOiAiOw0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQgX19yZXNwb25zZSA9IChuZXcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCgpKS0+Y29kZSgiWyIrdGhpc05vZGUuY29kZSgpKyJAdGltZSIrIl0uTm9kZS5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk5vZGUiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpqc29uIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZTo6YXV0aENvZGUoc3RkOjpzdHJpbmcgY29kZSwgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sJiB0b29sKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGU6OmF1dGhDb2RlKCk6ICI7DQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpFdmVudCBfX3Jlc3BvbnNlID0gKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5jb2RlKCJbIit0aGlzTm9kZS5jb2RlKCkrIkB0aW1lIisiXS5Ob2RlLmF1dGhDb2RlKCkiKS5tZXRob2QoImF1dGhDb2RlIikuY2xhc3NOYW1lKCJOb2RlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAganNvbiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoKHN0ZDo6c3RyaW5nKWFuc3dlcik7DQogICAgDQogICAgfWVsc2V7DQogICAgICAgIGpzb24gX2pSZXQ7DQogICAgICAgIF9qUmV0WyJfX3RoaXMiXSA9IHRoaXMtPl90b0RvY3VtZW50KCk7DQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChfalJldCk7DQogICAgICAgIC8vX19yZXNwb25zZS5wYXlsb2FkKHsiX190aGlzIjogdGhpcy0+X3RvRG9jdW1lbnQoKX0pOw0KICAgIH0NCg0KICAgIC8vX19yZXNwb25zZS50cmlnZ2VyKCk7DQoNCiAgICByZXR1cm4gYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGU6OmluaXQoaW50IG9ubGluZSwgc3RkOjpzdHJpbmcgY29kZSwgc3RkOjpzdHJpbmcgdWlkKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGU6OmluaXQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGUuaW5pdCgpIikubWV0aG9kKCJpbml0IikuY2xhc3NOYW1lKCJOb2RlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0Ojpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0Ojpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0Ojpjb250ZXh0X05vZGVzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fY29udGV4dF9Ob2RlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6OmNvbnRleHRfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9Db250ZXh0OjpfdW5pcXVlKCk6ICI7DQoNCiAgICBOb2RlX0NvbnRleHQqIHJldCA9IG5ldyBOb2RlX0NvbnRleHQoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5jb2RlKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+Y29kZSh0aGlzLT5jb2RlKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQ6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dD4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0PiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dDo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfQ29udGV4dDo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfQ29udGV4dC5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTm9kZV9Db250ZXh0IikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfQ29udGV4dD4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX0NvbnRleHQ6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfQ29udGV4dC5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk5vZGVfQ29udGV4dCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0PiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0NvbnRleHQmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0OjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX0NvbnRleHQ6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfQ29udGV4dC5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk5vZGVfQ29udGV4dCIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Db250ZXh0KiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OmNvZGUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvZGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6b3JkZXIoaW50IHYpew0KICAgIHRoaXMtPl9vcmRlciA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQppbnQgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpkYXRlKHRpbWVfdCB2KXsNCiAgICB0aGlzLT5fZGF0ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQp0aW1lX3QgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6bmFtZShzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fbmFtZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpyZW1hcmsoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X3JlbWFyayA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OnJlbWFyayhqc29uIHYpew0KICAgIC8vdGhpcy0+X3JlbWFyaw0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpyZW1hcmsoKXsNCiAgICByZXR1cm4gdGhpcy0+X3JlbWFyazsNCn0NCiAgICANCg0KICAgIA0Kc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpncm91cF9Ob2Rlcygpew0KICAgIHJldHVybiBtb3ZlKCoodGhpcy0+X2dyb3VwX05vZGVzKSk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpncm91cF9Ob2RlcyhzdGQ6OnZlY3RvcjxzdGQ6OmFueT4mJiB2KXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfR3JvdXA6Ol91bmlxdWUoKTogIjsNCg0KICAgIE5vZGVfR3JvdXAqIHJldCA9IG5ldyBOb2RlX0dyb3VwKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCiAgICAgICAgDQogICAgaWYodGhpcy0+bmFtZSgpLmVtcHR5KCkpDQogICAgICAgIA0KICAgICAgICByZXQtPm5hbWUodGhpcy0+bmFtZSgpKTsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cD4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cDo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9Hcm91cCYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9Hcm91cDo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfR3JvdXAuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk5vZGVfR3JvdXAiKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXAqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfR3JvdXA6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfR3JvdXAuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJOb2RlX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfR3JvdXA6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfR3JvdXA6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfR3JvdXAuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJOb2RlX0dyb3VwIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX0dyb3VwKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6YWN0aXZlKGJvb2wgdil7DQogICAgdGhpcy0+X2FjdGl2ZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjplbmFibGVkKGJvb2wgdil7DQogICAgdGhpcy0+X2VuYWJsZWQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KYm9vbCBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpjb2RlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jb2RlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpjb2RlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb2RlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpvcmRlcigpew0KICAgIHJldHVybiB0aGlzLT5fb3JkZXI7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6ZGF0ZSh0aW1lX3Qgdil7DQogICAgdGhpcy0+X2RhdGUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KdGltZV90IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpkYXRlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9kYXRlOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6Om5hbWUoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X25hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6Om5hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X25hbWU7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6cmVtYXJrKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9yZW1hcmsgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6cmVtYXJrKGpzb24gdil7DQogICAgLy90aGlzLT5fcmVtYXJrDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6cmVtYXJrKCl7DQogICAgcmV0dXJuIHRoaXMtPl9yZW1hcms7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6ZHluYW1pYyhib29sIHYpew0KICAgIHRoaXMtPl9keW5hbWljID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OmR5bmFtaWMoKXsNCiAgICByZXR1cm4gdGhpcy0+X2R5bmFtaWM7DQp9DQogICAgDQoNCiAgICANCnN0ZDo6dmVjdG9yPHN0ZDo6YW55PiYmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjp0eXBlX05vZGVzKCl7DQogICAgcmV0dXJuIG1vdmUoKih0aGlzLT5fdHlwZV9Ob2RlcykpOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6OnR5cGVfTm9kZXMoc3RkOjp2ZWN0b3I8c3RkOjphbnk+JiYgdil7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6X3VuaXF1ZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTm9kZV9UeXBlOjpfdW5pcXVlKCk6ICI7DQoNCiAgICBOb2RlX1R5cGUqIHJldCA9IG5ldyBOb2RlX1R5cGUoKTsNCiAgICBpZih0aGlzLT5JZCE9MCkgcmV0LT5JZCA9IHRoaXMtPklkOw0KICAgIA0KICAgICAgICANCiAgICBpZih0aGlzLT5uYW1lKCkuZW1wdHkoKSkNCiAgICAgICAgDQogICAgICAgIHJldC0+bmFtZSh0aGlzLT5uYW1lKCkpOw0KICAgIA0KDQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZSYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGU6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpfZnJvbURvY3VtZW50KHN0ZDo6c3RyaW5nIG9iail7DQogICAgaWYob2JqLmVtcHR5KCkpIHJldHVybiAqdGhpczsNCg0KICAgIGlmIChzdGQ6OnJlZ2V4X21hdGNoKG9iaiwgc3RkOjpyZWdleChSIiIoKChbQS1aYS16XXszLDl9Oig/Oi8vKT8pKD86Wy07OiY9KyQsd10rQCk/W0EtWmEtejAtOS4tXSt8KD86d3d3LnxbLTs6Jj0rJCx3XStAKVtBLVphLXowLTkuLV0rKSgoPzovWyt+JS8udy1fXSopPz8/KD86Wy0rPSY7JUAud19dKikjPyg/Olt3XSopKT8pIiIpKSl7DQogICAgICAgIHN0ZDo6c3RyaW5nIHJlYWRCdWZmZXI7DQogICAgICAgIENVUkwgKmN1cmwgPSBjdXJsX2Vhc3lfaW5pdCgpOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfVVJMLCBvYmopOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIDFMKTsNCiAgICAgICAgLy9jdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVGVU5DVElPTiwgK1tdKHZvaWQgKnB0ciwgc2l6ZV90IHNpemUsIHNpemVfdCBubWVtYiwgdm9pZCAqc3RyZWFtKSAtPiBzaXplX3QgeyByZWFkQnVmZmVyLmFwcGVuZCgqcHRyLCBzaXplICogbm1lbWIpOyB9KTsNCiAgICAgICAgY3VybF9lYXN5X3NldG9wdChjdXJsLCBDVVJMT1BUX1dSSVRFREFUQSwgJnJlYWRCdWZmZXIpOw0KICAgICAgICBjdXJsX2Vhc3lfcGVyZm9ybShjdXJsKTsNCiAgICAgICAgY3VybF9lYXN5X2NsZWFudXAoY3VybCk7DQogICAgICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KHJlYWRCdWZmZXIpOw0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLT5fZnJvbURvY3VtZW50KGpzb246OnBhcnNlKG9iaikpOw0KfQ0KDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZT4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6X2Zyb21Eb2N1bWVudHMoanNvbiBvYmopew0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlPiByZXQgPSBuZXcgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6X2Zyb21Eb2N1bWVudChqc29uIG9iail7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZTo6c3RvcmUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk5vZGVfVHlwZTo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfVHlwZS5zdG9yZSgpIikubWV0aG9kKCJzdG9yZSIpLmNsYXNzTmFtZSgiTm9kZV9UeXBlIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok5vZGVfVHlwZT4mIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpmaW5kQWxsKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX1R5cGU6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfVHlwZS5maW5kQWxsKCkiKS5tZXRob2QoImZpbmRBbGwiKS5jbGFzc05hbWUoIk5vZGVfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIHN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpOb2RlX1R5cGUmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlOjpmaW5kKCl7DQogICAgc3RkOjpzdHJpbmcgX190b1N0cmluZyA9ICJOb2RlX1R5cGU6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk5vZGVfVHlwZS5maW5kKCkiKS5tZXRob2QoImZpbmQiKS5jbGFzc05hbWUoIk5vZGVfVHlwZSIpLmNhcnJpZXIodGhpc05vZGUpLnNlbmRlcih0aGlzTm9kZSkucmVjaXBpZW50KHRoaXNOb2RlLnBhcmVudCgpKTsNCg0KICAgIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6Tm9kZV9UeXBlKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjphY3RpdmUoYm9vbCB2KXsNCiAgICB0aGlzLT5fYWN0aXZlID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmJvb2wgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjphY3RpdmUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2FjdGl2ZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmVuYWJsZWQoYm9vbCB2KXsNCiAgICB0aGlzLT5fZW5hYmxlZCA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpib29sIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6ZW5hYmxlZCgpew0KICAgIHJldHVybiB0aGlzLT5fZW5hYmxlZDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Om9yZGVyKGludCB2KXsNCiAgICB0aGlzLT5fb3JkZXIgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KaW50IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6b3JkZXIoKXsNCiAgICByZXR1cm4gdGhpcy0+X29yZGVyOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6Y2xhc3NOYW1lKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9jbGFzc05hbWUgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpjbGFzc05hbWUoKXsNCiAgICByZXR1cm4gdGhpcy0+X2NsYXNzTmFtZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnNjb3BlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9zY29wZSA9IHY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnNjb3BlKCl7DQogICAgcmV0dXJuIHRoaXMtPl9zY29wZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmNvbnRleHQoc3RkOjpzdHJpbmcgdil7DQogICAgdGhpcy0+X2NvbnRleHQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpjb250ZXh0KCl7DQogICAgcmV0dXJuIHRoaXMtPl9jb250ZXh0Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6c291cmNlKHN0ZDo6c3RyaW5nIHYpew0KICAgIHRoaXMtPl9zb3VyY2UgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0Kc3RkOjpzdHJpbmcgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpzb3VyY2UoKXsNCiAgICByZXR1cm4gdGhpcy0+X3NvdXJjZTsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnRhcmdldChzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fdGFyZ2V0ID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6dGFyZ2V0KCl7DQogICAgcmV0dXJuIHRoaXMtPl90YXJnZXQ7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjppblNjcmlwdChzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5faW5TY3JpcHQgPSB2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjppblNjcmlwdChqc29uIHYpew0KICAgIC8vdGhpcy0+X2luU2NyaXB0DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmluU2NyaXB0KCl7DQogICAgcmV0dXJuIHRoaXMtPl9pblNjcmlwdDsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Om91dFNjcmlwdChzdGQ6OnN0cmluZyB2KXsNCiAgICB0aGlzLT5fb3V0U2NyaXB0ID0gdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6b3V0U2NyaXB0KGpzb24gdil7DQogICAgLy90aGlzLT5fb3V0U2NyaXB0DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQpzdGQ6OnN0cmluZyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Om91dFNjcmlwdCgpew0KICAgIHJldHVybiB0aGlzLT5fb3V0U2NyaXB0Ow0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6dG9vbChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2wmIHYpew0KICAgIHRoaXMtPl90b29sID0gJnY7DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OnRvb2woZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpUb29sKiB2KXsNCiAgICBpZih2IT1udWxscHRyKXsNCiAgICAgICAgdGhpcy0+X3Rvb2wgPSB2Ow0KICAgIH0NCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6VG9vbCogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjp0b29sKCl7DQogICAgcmV0dXJuIHRoaXMtPl90b29sOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6Z3JvdXAoZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAmIHYpew0KICAgIHRoaXMtPl9ncm91cCA9ICZ2Ow0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpncm91cChlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkNvbmZpZ19Hcm91cCogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl9ncm91cCA9IHY7DQogICAgfQ0KICAgIHJldHVybiAqdGhpczsNCn0NCiAgICANCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpDb25maWdfR3JvdXAqIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6Z3JvdXAoKXsNCiAgICByZXR1cm4gdGhpcy0+X2dyb3VwOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSYgdil7DQogICAgdGhpcy0+X3R5cGUgPSAmdjsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQogICAgDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6dHlwZShlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogdil7DQogICAgaWYodiE9bnVsbHB0cil7DQogICAgICAgIHRoaXMtPl90eXBlID0gdjsNCiAgICB9DQogICAgcmV0dXJuICp0aGlzOw0KfQ0KICAgIA0KDQplc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OlRvb2xfVHlwZSogZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjp0eXBlKCl7DQogICAgcmV0dXJuIHRoaXMtPl90eXBlOw0KfQ0KICAgIA0KDQogICAgDQoNCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Ol91bmlxdWUoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmc6Ol91bmlxdWUoKTogIjsNCg0KICAgIE1hcHBpbmcqIHJldCA9IG5ldyBNYXBwaW5nKCk7DQogICAgaWYodGhpcy0+SWQhPTApIHJldC0+SWQgPSB0aGlzLT5JZDsNCiAgICANCg0KICAgIHJldHVybiAqdGhpczsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Ol9mcm9tRG9jdW1lbnQodW5zaWduZWQgY2hhciogb2JqKXsNCiAgICByZXR1cm4gdGhpcy0+X2Zyb21Eb2N1bWVudChzdGQ6OnN0cmluZyggb2JqLCBvYmogKyBzaXplb2Ygb2JqIC8gc2l6ZW9mIG9ialswXSApKTsNCn0NCg0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Ol9mcm9tRG9jdW1lbnQoc3RkOjpzdHJpbmcgb2JqKXsNCiAgICBpZihvYmouZW1wdHkoKSkgcmV0dXJuICp0aGlzOw0KDQogICAgaWYgKHN0ZDo6cmVnZXhfbWF0Y2gob2JqLCBzdGQ6OnJlZ2V4KFIiIigoKFtBLVphLXpdezMsOX06KD86Ly8pPykoPzpbLTs6Jj0rJCx3XStAKT9bQS1aYS16MC05Li1dK3woPzp3d3cufFstOzomPSskLHddK0ApW0EtWmEtejAtOS4tXSspKCg/Oi9bK34lLy53LV9dKik/Pz8oPzpbLSs9JjslQC53X10qKSM/KD86W3ddKikpPykiIikpKXsNCiAgICAgICAgc3RkOjpzdHJpbmcgcmVhZEJ1ZmZlcjsNCiAgICAgICAgQ1VSTCAqY3VybCA9IGN1cmxfZWFzeV9pbml0KCk7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9VUkwsIG9iaik7DQogICAgICAgIGN1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgMUwpOw0KICAgICAgICAvL2N1cmxfZWFzeV9zZXRvcHQoY3VybCwgQ1VSTE9QVF9XUklURUZVTkNUSU9OLCArW10odm9pZCAqcHRyLCBzaXplX3Qgc2l6ZSwgc2l6ZV90IG5tZW1iLCB2b2lkICpzdHJlYW0pIC0+IHNpemVfdCB7IHJlYWRCdWZmZXIuYXBwZW5kKCpwdHIsIHNpemUgKiBubWVtYik7IH0pOw0KICAgICAgICBjdXJsX2Vhc3lfc2V0b3B0KGN1cmwsIENVUkxPUFRfV1JJVEVEQVRBLCAmcmVhZEJ1ZmZlcik7DQogICAgICAgIGN1cmxfZWFzeV9wZXJmb3JtKGN1cmwpOw0KICAgICAgICBjdXJsX2Vhc3lfY2xlYW51cChjdXJsKTsNCiAgICAgICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQocmVhZEJ1ZmZlcik7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMtPl9mcm9tRG9jdW1lbnQoanNvbjo6cGFyc2Uob2JqKSk7DQp9DQoNCnN0ZDo6dmVjdG9yPGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZz4mJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6Ol9mcm9tRG9jdW1lbnRzKGpzb24gb2JqKXsNCiAgICBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc+IHJldCA9IG5ldyBzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcmPihvYmouc2l6ZSgpKTsNCiAgICANCiAgICByZXR1cm4gbW92ZSgqKnJldCk7DQp9DQoNCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpfZnJvbURvY3VtZW50KGpzb24gb2JqKXsNCiAgICByZXR1cm4gKnRoaXM7DQp9DQoNCnN0ZDo6c3RyaW5nIGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZzo6X3RvRG9jdW1lbnQoKXsNCiAgICByZXR1cm4gIiI7DQp9DQoNCiAgICANCmVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6TWFwcGluZyYgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nOjpzdG9yZSgpew0KICAgIHN0ZDo6c3RyaW5nIF9fdG9TdHJpbmcgPSAiTWFwcGluZzo6c3RvcmUoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmcuc3RvcmUoKSIpLm1ldGhvZCgic3RvcmUiKS5jbGFzc05hbWUoIk1hcHBpbmciKS5jYXJyaWVyKHRoaXNOb2RlKS5zZW5kZXIodGhpc05vZGUpLnJlY2lwaWVudCh0aGlzTm9kZS5wYXJlbnQoKSk7DQoNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmcqIGFuc3dlcjsNCg0KICAgIA0KDQogICAgDQogICAgaWYoYW5zd2VyIT1udWxscHRyKXsNCiAgICANCg0KICAgIA0KICAgICAgICANCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKGFuc3dlci0+X3RvRG9jdW1lbnQoKSk7DQogICAgICAgIA0KICAgIA0KICAgIH1lbHNlew0KICAgICAgICBqc29uIF9qUmV0Ow0KICAgICAgICBfalJldFsiX190aGlzIl0gPSB0aGlzLT5fdG9Eb2N1bWVudCgpOw0KICAgICAgICBfX3Jlc3BvbnNlLnBheWxvYWQoX2pSZXQpOw0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZCh7Il9fdGhpcyI6IHRoaXMtPl90b0RvY3VtZW50KCl9KTsNCiAgICB9DQoNCiAgICAvL19fcmVzcG9uc2UudHJpZ2dlcigpOw0KDQogICAgcmV0dXJuICphbnN3ZXI7DQp9DQogICAgDQpzdGQ6OnZlY3Rvcjxlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc+JiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmZpbmRBbGwoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmc6OmZpbmRBbGwoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmcuZmluZEFsbCgpIikubWV0aG9kKCJmaW5kQWxsIikuY2xhc3NOYW1lKCJNYXBwaW5nIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgc3RkOjp2ZWN0b3I8ZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nPiogYW5zd2VyOw0KDQogICAgDQoNCiAgICANCiAgICBpZihhbnN3ZXItPmVtcHR5KCkpew0KICAgIA0KDQogICAgDQogICAgICAgIA0KICAgICAgICAvL19fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nJiBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206Ok1hcHBpbmc6OmZpbmQoKXsNCiAgICBzdGQ6OnN0cmluZyBfX3RvU3RyaW5nID0gIk1hcHBpbmc6OmZpbmQoKTogIjsNCiAgICBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50IF9fcmVzcG9uc2UgPSAobmV3IGVzcHRlc3Q6OmNvbTo6bmFtbW91cjo6ZGNvbTo6RXZlbnQoKSktPmNvZGUoIlsiK3RoaXNOb2RlLmNvZGUoKSsiQHRpbWUiKyJdLk1hcHBpbmcuZmluZCgpIikubWV0aG9kKCJmaW5kIikuY2xhc3NOYW1lKCJNYXBwaW5nIikuY2Fycmllcih0aGlzTm9kZSkuc2VuZGVyKHRoaXNOb2RlKS5yZWNpcGllbnQodGhpc05vZGUucGFyZW50KCkpOw0KDQogICAgZXNwdGVzdDo6Y29tOjpuYW1tb3VyOjpkY29tOjpNYXBwaW5nKiBhbnN3ZXI7DQoNCiAgICANCg0KICAgIA0KICAgIGlmKGFuc3dlciE9bnVsbHB0cil7DQogICAgDQoNCiAgICANCiAgICAgICAgDQogICAgICAgIF9fcmVzcG9uc2UucGF5bG9hZChhbnN3ZXItPl90b0RvY3VtZW50KCkpOw0KICAgICAgICANCiAgICANCiAgICB9ZWxzZXsNCiAgICAgICAganNvbiBfalJldDsNCiAgICAgICAgX2pSZXRbIl9fdGhpcyJdID0gdGhpcy0+X3RvRG9jdW1lbnQoKTsNCiAgICAgICAgX19yZXNwb25zZS5wYXlsb2FkKF9qUmV0KTsNCiAgICAgICAgLy9fX3Jlc3BvbnNlLnBheWxvYWQoeyJfX3RoaXMiOiB0aGlzLT5fdG9Eb2N1bWVudCgpfSk7DQogICAgfQ0KDQogICAgLy9fX3Jlc3BvbnNlLnRyaWdnZXIoKTsNCg0KICAgIHJldHVybiAqYW5zd2VyOw0KfQ0KICAgIA0KDQoNCmludCBtYWluKGludCBhcmdjLCBjaGFyKiBhcmd2W10pIHsNCg0KICAgIGNvbnN0IHN0ZDo6c3RyaW5nIFNFUlZFUl9BRERSRVNTKCJtcXR0Oi8vdGVzdC5tb3NxdWl0dG8ub3JnOjE4ODMiKTsNCiAgICBtcXR0Ojphc3luY19jbGllbnQgY2xpKFNFUlZFUl9BRERSRVNTLCAiIiwgbXF0dDo6Y3JlYXRlX29wdGlvbnMoTVFUVFZFUlNJT05fNSkpOw0KICAgIGNsaS5zZXRfbWVzc2FnZV9jYWxsYmFjayhbXShtcXR0Ojpjb25zdF9tZXNzYWdlX3B0ciBtc2cpIHsgKG5ldyBlc3B0ZXN0Ojpjb206Om5hbW1vdXI6OmRjb206OkV2ZW50KCkpLT5fZnJvbURvY3VtZW50KG1zZy5nZXRfcGF5bG9hZF9zdHIoKSkucHJvY2VzcygpOyB9KTsNCiAgICBhdXRvIHRvayA9IGNsaS5jb25uZWN0KG1xdHQ6OmNvbm5lY3Rfb3B0aW9uc19idWlsZGVyKCkNCgkJLnByb3BlcnRpZXMoew0KCQkJe21xdHQ6OnByb3BlcnR5OjpTRVNTSU9OX0VYUElSWV9JTlRFUlZBTCwgNjA0ODAwfQ0KCQl9KQ0KCQkuY2xlYW5fc3RhcnQoZmFsc2UpDQoJCS8vLndpbGwoc3RkOjptb3ZlKGx3dCkpDQoJCS5rZWVwX2FsaXZlX2ludGVydmFsKHN0ZDo6Y2hyb25vOjpzZWNvbmRzKDIwKSkNCgkJLmZpbmFsaXplKCkpOw0KICAgIHRvay53YWl0KCk7DQoNCiAgICByZXR1cm4gMDsNCn0=",
	"__keys": ["name"],
	"__trMap": []
}